2020 IEEE International Conference on Robotics and Automation (ICRA)
31 May - 31 August, 2020. Paris, France
Bi-Convex Approximation of Non-Holonomic Trajectory Optimization
Arun Kumar Singh 1, Raghu Ram Theerthala2, Mithun Babu2, Unni Krishnan R Nair2, K.Madhava Krishna2
Abstract—Autonomous cars and ﬁxed-wing aerial vehicles
havetheso-callednon-holonomickinematicswhichnon-linearly
mapscontrolinputtostates.Asaresult,trajectoryoptimization
with such a motion model becomes highly non-linear and non-
convex.Inthispaper,weimprovethecomputationaltractability
of non-holonomic trajectory optimization by reformulating it
in terms of a set of bi-convex cost and constraint functions
along with a non-linear penalty. The bi-convex part acts as a
relaxation for the non-holonomic trajectory optimization while
theresidualofthepenaltydictateshowwellitsoutputobeysthe Fig.1. Oneofthebuildingblocksoftheproposedtrajectoryoptimizer.(cid:101)The
non-holonomicbehavior.Weadoptanalternatingminimization magentasurfacerepresentsanon-convexfunctionf(θ)whichhasmultiple
approach for solving the reformulated problem and show that local minima. However, it is possible to derive a convex surrogate f(θ)
it naturally leads to the replacement of the challenging non- (showninblack)thatextractsoneofthelocalminimaoff.
linearpenaltywithagloballyvalidconvexsurrogate.Alongwith
the common cost functions modeling goal-reaching, trajectory the problem. For example, consider the problem of com-
smoothness,etc.,theproposedoptimizercanalsoaccommodate puting a rank-1 approximation of a given matrix. Instead
aclassofnon-linearcostsformodelinggoal-sets,whileretaining
of treating it as an NLP and applying gradient descent on
thebi-convexstructure.Webenchmarktheproposedoptimizer
it, we can exploit the bi-convex structure of the problem
against off-the-shelf solvers implementing sequential quadratic
programming and interior-point methods and show that it and employ algorithms like alternating minimization which
produces solutions with similar or better cost as the former leadstoclosedformsolution[10].Theproposedworkbrings
while signiﬁcantly outperforming the latter. Furthermore, as similarperspectivetonon-holonomictrajectoryoptimization.
compared to both off-the-shelf solvers, the proposed optimizer
Contributions and Overview of the Proposed Optimizer:
achieves more than 20x reduction in computation time.
In this paper, we reduce non-holonomic trajectory optimiza-
I. INTRODUCTION tion to a problem of solving a sequence of globally valid
The computational ease with which a trajectory optimiza- convex QPs. The term "globally valid" is the key here as
tioncanbesolveddependscriticallyonthemotionmodelof it differentiates the proposed optimizer with existing SQP
therobot.Forexample,forquadrotorswhichcanbemodeled based approaches like [11] (see Section III for details). At
as an afﬁne system (series of integrators), generating a the core of our formulation is a simple insight that although
smoothtrajectorythroughasetofwaypointstakestheshape the non-holonomic motion model is highly non-linear in
ofaconvexquadraticprogramme[1].Eveninthepresenceof the space of velocity v and heading angle φ , it is bi-
t t
obstacles, trajectory optimization can be shown to have the afﬁne in the space of v and (cosφ ,sinφ ). Furthermore,
t t t
difference of convex form which can be solved efﬁciently we show that it is possible to induce similar structure in the
using the convex-concave procedure [2], [3]. In contrast, collision avoidance constraints as well. Using these insights,
autonomous cars and ﬁxed wing aerial vehicles (FWV) we reformulate non-holonomic trajectory optimization in
have the so called non-holonomic kinematics that results terms of a set of bi-convex cost and constraint functions
in a non-linear mapping between the control input and the alongwithanon-linearpenalty(see10a).Thebi-convexpart
states.Trajectoryoptimizationwithsuchmotionmodelstake canbeinterpretedasacomputationallysimplerrelaxationfor
the form of a challenging non-linear programming problem thenon-holonomictrajectoryoptimizationwhiletheresidual
(NLP)[4].Nevertheless,techniqueslikegradientdescent[5], of the penalty quantiﬁes how well its output obeys the
[6],sequentialquadraticprogramming(SQP)[7]andprimal- non-holonomic behavior. The non-linear penalty can also be
dualinteriorpointimplementedinopen-sourcepackageslike viewedasaprojectionoperatorwhichmapstheoutputofthe
SciPy [8], IPOPT [9] etc., can be employed to obtain a bi-convex part back to the space of feasible non-holonomic
locally optimal solution. motions.
The intractability of an NLP can be countered to a large The primary complexity of the reformulated problem
extent by exploiting the niche mathematical structures of stems from minimizing the non-linear penalty. However,
we show that by adopting an alternating (Gauss-Seidal)
1. Institute of Technology, University of Tartu. 2. Robotics Research
minimization approach [12], we naturally arrive at a convex
Center, IIIT-Hyderabad, India. This work was in part funded by the Eu-
ropeanSocialFundthroughITAcademyofEstoniaGrant(SLTTI19605T) surrogate for replacing the non-linear penalty (see Fig.1).
to the ﬁrst author, Estonian Centre of Excellence in IT (EXCITE) funded We validate the proposed trajectory optimizer on common
by the European Regional Development Fund, base funding of University
benchmarks encountered in autonomous driving. For FWV,
of Tartu Grant 20907, and UT-Bolt Consortium on Autonomous Driving
(LLTAT19380). we consider the problem of guiding it through obstacles to
978-1-7281-7395-5/20/$31.00 ©2020 IEEE 476
Authorized licensed use limited to: UNIVERSITY OF ROCHESTER. Downloaded on September 20,2020 at 15:45:56 UTC from IEEE Xplore.  Restrictions apply. a periodic path. In this context, we consider a class of non- variables with piece-wise constant linear and angular jerk.
linearcostandshowhowitcanbeaccommodatedwithinour Using (3), the non-holonomic trajectory optimization can be
trajectory optimizer while retaining the bi-convex structure. framed as the following non-linear programming problem.
Furthermore, we show that on all the considered examples, arg min f (c ,c )+f (c )+f (c ). (4a)
our trajectory optimizer produces solution with similar cost cx,cy,cv,cφ xy x y v v φ φ∀
asofftheshelfsolversbasedonSQPbutsigniﬁcantlyoutper- gt(cx,cy,cv,cφ)=0≤, t. (4b)
forms those based on interior point methods. Furthermore, hv(cv)≤0. (4c)
withrespecttoboththesetechniques,theproposedoptimizer hφ(cφ)≤0. (4d)
achieves more than 20x reduction in computation time (see h (c ,c ) 0. (4e)
curv φ vel
≤ ∀ ∀
Section IV). hj (c ,c ,c ) 0, t, j. (4f)
ot x y φ
II. PROBLEMFORMULATION The function g is obtained by substituting (3) into the ﬁrst
t
two equations of (2a). The cost function f model costs
A. Preliminaries xy
which explicitly depend on x ,y and their derivatives such
Symbols and Notations: We will use lower normal faced as goal-reaching, lateral accelterattion, etc. and has a convex
letters to represent scalars while bold-faced variants would quadratic form. The cost terms f ,f model regularization
v φ
represent vectors. Matrices are represented by bold upper on velocity, acceleration and jerk and have the same form
case letters. We represent the time dependency of the vari- as f . The functions h ,h ,h in (4c)-(4e) are afﬁne
xy v φ curv
ablesthroughsubscriptt.ThesuperscriptT wouldrepresent and model the bounds on linear and angular velocities,
transpose of a row/column vector or a matrix. With a slight accelerations, jerk and curvature. Inequalities (4f) represent
abuse of notation, we use the same symbol f to represent a the collision avoidance constraints with respect to the jth
generic function at different places. obstacle.
Bi-Convexity and Alternating Minimization:
The computational bottleneck of (4a)-(4f) stems from the
Deﬁnition 1. A function f(z1,z2) is bi-convex (bi-afﬁne) if for a fact that gt is highly non-linear comprising of trigonometric
given z , f is convex (afﬁne) in z and vice-versa. sine and cosine function of c . Depending on the obstacle
1 2 φ
Alternating Minimization: Given a function f(z ,z ), the geometry, the same non-linearity may also manifest in the
alternating (or Gauss Seidel) minimization proceed1s th2rough function hj . Existing works solve (4a)-(4f) as a standard
the following iterates [12]. NLP usingotalgorithms like SQP. In the next section, we
zk+1 =argminf(z ,zk),zk+1 =argminf(zk+1,z ), (1) presentafundamentallydifferentapproachwhereweexploit
1 z1 1 2 2 z2 1 2 the mathematical structures in g and hj to reduce (4a)-(4f)
where, the superscript k refers to the value of the respective to a set of globally valid convext QPs. ot
variable at iteration k. If function f is bi-convex in z ,z ,
theneachoftheminimizationin(1)isaconvexoptimiz1atio2n III. MAINRESULTS
problem. In this section, we present a bi-convex approximation of
MotionModel:Weconsiderthefollowingmotionmodelfor (4a)-(4f).Webeginbydescribingthevariousbuildingblocks.
non-holonomic car-like vehicles.
... A. Convex Surrogate
x˙ =v cosφ , y˙ =v sinφ , v¨ =u1, φ =u2. (2a)
t t t t t t t t t t The discussions presented here builds upon our prior work
− ≤ ≤ ∀
vtκmax φ˙t vtκmax, t, (2b) [13],[14].Considerthefollowingtwooptimizationproblems
where, xt,yt,vt,φt represent the time-dependent Cartesian in term of variable θ for the−giv(cid:18)en constants−ws(cid:19)and wc.
position, forward velocity and heading angle of the vehicle minf,f =(cos((cid:101)θ)(cid:101) wc)2+(sin(θ) ws)2 (5a)
respectively. The control inputs (u1,u2) are taken as the lin- θ
t t − w 2
earandangularjerk.Inequality(2b)representsthecurvature minf,f = θ arctan2 s (5b)
bound. The parameter κ is related to max steering angle θ wc
max
δ and inter-axle distance l as κ = tan(δmax). The loss surface of f is shown in (cid:101)Fig.1 (in magenta)
max max l and consists of multiple minima, although all of them are
B. Trajectory Optimization of equal value. (cid:101)On the other hand, f is a linear least-
To ensure smooth trajectories, we represent the position, squares function with a single global minima. Interestingly,
(cid:53) (cid:53)
heading and velocity variables in the following functional f = 0 and f = 0 have a common solution given by
form. θ(cid:101)=arctan2(ws). Consequently, optimization (5a) and (5b)
shareacommowncminima.Analternativein(cid:101)terpretationisthat
x =p c ,y =p c ,φ =p c ,v=p c , (3)
t t x t t y t t φ vt v f acts as a convex surrogate for f. From anywhere in the θ
where, p is a row vector formed with time-dependent cubic space, one can follow(cid:101) the loss surface of f to extract one of
t
splinebasisfunctions.Similarly,p isformedwithquadratic the minima of f. Now, the very nature of arctan2 function
polynomial basis functions. The vvtariables c ,c ,c ,c are would ensure that f always extracts the minima from the
x y v φ | | ≤
the coefﬁcients associated with the basis functions. The region θ π. However, this is a minor limitation, if we
higher-orderderivativescanbecomputedthroughp˙ ,p¨ ,etc. assume that θ actually represents an angle, in which case
C t t | |≤
The chosen form ensures 2 continuity in all the trajectory θ π is large enough to cover the whole rotation range.
477
Authorized licensed use limited to: UNIVERSITY OF ROCHESTER. Downloaded on September 20,2020 at 15:45:56 UTC from IEEE Xplore.  Restrictions apply. B. Mathematical Structure of hj Representation of g in the form given by (9a) is straight-
ot forwardandfollowsditrectlyfromsubstituting(3)in(2a)and
We follow [4] and approximate the geometry of the ego-
subsequently performing the change of variables presented
vehiclethroughmultiplecirclesandobstaclesasaxisrotated
in (8). Similarly, hj as (9b) directly follows from (3), (7)
exCltolinp+sseerqsi.uceLonsetltφy,tt,hytehtiei=thobcsytitarcc+lleerciaesvniontiedφratnbcfeeor(cxsoiton,msyttier)aicnwotnitshftuannxctittiro=in. adnedter(m8)i.neTdhebymtahtericpoeatsrtiAaljxyd,eArijφvaatinvdesvienct(o7r)fajontdarpe.constants
t
betweentheith circleoftheego-vehicleandthejth obstacle In (9a), Ag is a matrix whose elements are afﬁne func-
ellipse can be written as tions of c . Similarly b is a vector whose elements are
v g
afﬁne functions of c ,c . Clearly, (9a) represents a bi-afﬁne
x y
−hiojdt12=(−−(xd1it2x−((xxitotj−)sxiotnj()αctoojs)(+αto(jy)ti+−(yyttoij−)cyotosj()αstoijn)()α2to+j))12, (6) f(a(u4wnnfdc)cttw,iinwocnttsh,twie)n.sfSttoe.ilrmlUmoiwslsiainrnoglgfy(tf8hwo)jorotmanbi.sdlocc(o9knavo)-ef(x9vbai)nr,iatwbheleesrsep(facocxrem,couyfl,ac(tecvx)(,4acany)d)-
y
L
wxohje,ryeo,j,hαiojtojrreepsrpeescetnivtseltyherepirtheseenletmtheencteonfterhjoatn.dTahxeistaenrgmles (cid:88)cv,cx(cid:122),cy,(cid:20)cmφ,iwnct(cid:125),(cid:124)wst,θt (cid:21)(c(cid:123)v,cx,cy,c(cid:20)φ,w(cid:21)ct,wst)+
t t t consensus
ofthejth obstacleellipseattimet.Theconstantsd ,d are −
x y (cid:107) w cosθ (cid:107) w
thelengthofitsmajorandminoraxisrespectivelyinﬂatedby ρ ct − t 2+λ T ct +λ θ (10a)
theradiusoftheith circleoftheego-vehicle.Functionhij is t c wst sinθt 2 wt wst θt t
hcoignhvleyx)noinn-litneeramrswoitfh rveasrpiaebcltetoxφ,tybutanisdco(cnocsavφe,(srienvoeφtrs)e. hv,hφ,hθtcu=rvp≤tcφ0 ((1100bc))
t t t t ≤
Thus, it can be replaced with its afﬁne approximation (7) hj (c ,c ,w ,w ) 0 (10d)
(cid:88) ot x y ct st
obtained by Taylor series expansion around some guess L
(xˆ ,yˆ,cosφˆ ,sinφˆ ). Irrespective of the expansion point, (cv,cx,cy,cφ,wct,wst)=fxy(cx,cy)+fv(cv)+fφ(cφ)
t t t t (cid:107) (cid:107)
the satisfaction of (7) ensures the satisfaction of original + λT (g (c ,c ,c ,w ,w ))+ρ g (c ,c ,c ,w ,w ) 2
gt t x y v ct st g t x y v ct st 2
quadratic inequality (6) and consequently, the former acts t
As can be seen, we have reformulated the equality con-
as a convex (over) approximation of the latter [2].
straints (4b) as a quadratic penalty along with a Lagrangian
hiojt = ∂∂hxiotjtxt+ ∂∂hyiotjtyt+ ∂c∂ohs(iojφtt)cos(φt) taedrdmitiowniathl nmonu-ltliipnleiaerr pλegnta.ltTyhwehcicohstefnusnucrteisonthaelscoonhsaesnsauns
+∂s∂inh(ioφjtt)sin(φt)+foijt(xˆt,yˆt,cos(φˆt),sin(φˆt)). (7) bLeatgwraenengiawncttearmnds cwoisthθtλand abnedtwλeen awrestaadnddedsitnoθte.nsTuhree
wt θt
Note that we take the partial derivative with respect to that the consensus residual is driven very close to zero [13].
(cosφ ,sinφ ) and not φ . The partial derivatives and fij There is also an additional equality constraint which forces
are scatlar contstants whoset numerical values are determineodt agreement between θ and p c . Note that L is bi-convex in
t t φ
by the expansion point (xˆ ,yˆ,cosφˆ ,sinφˆ ). two blocks of variable (c ,c ,c ,c ) and (w ,w ).
t t t t v x y φ ct st
It is worth pointing out that the substitution of concave The form presented in (10a)-(10c) has a simple intuitive
collisionavoidanceconstraintswithmoreconservativeafﬁne interpretation. If we disregard, the difﬁcult consensus terms
approximation has been exploited in many works but for inthecostfunction,wegetabi-convexoptimizationproblem
robots with afﬁne motion model (e.g. quadrotors [3]). How- which can be efﬁciently solved through alternating mini-
ever,thisresultuntilnowhadlimitedutilityinthecontextof mization algorithm. However, the resulting trajectory will
non-holonomic trajectory optimization due to the presence not obey the non-holonomic kinematics. But as we reduce
of trigonometric variables in (6). As we have shown, the the consensus residuals, the resulting trajectory would start
key idea is to compute the afﬁne approximation, not in the approaching the non-holonomic behavior.
space of φ but rather (cosφ ,sinφ ) which we next show Ontheﬁrstlook,(10a)-(10d)resembleatrivialre-phrasing
t t t
ﬁts perfectly into the proposed trajectory optimizer. of (4a)-(4f) and with no clear computational advantage. In
particular, the non-linear consensus penalty makes (10a)-
C. Reformulating and solving (4a)-(4f)
(10d) potentially as difﬁcult as (4a)-(4e). Thus, to explicitly
The reformulations presented here consists of two key steps. highlight the utility of the former, we next apply alternating
First, we introduce the following change of variables minimization algorithm on it.
Given an initial guess for ck,ck,ck,ck,θk at k = 0,
θ =p c ,w =cosθ ,w =sinθ (8) φ v x y t
t t φ ct t st t the solution of (10a)-(10d) proceeds through the iterates
Second, we note that the functio(cid:20)ns g(cid:21) and hj have the presentedinAlgorithm1,wherethesuperscriptk represents
following general structure. t ot thevalueoftherespectivevariableatiterationk.Steps(13a)-
(cid:20) (cid:21) (cid:20) (cid:21) (13c) are similar to (1) and involves solving convex QPs.
gt =Ag(cv) wwct +bg(cx,cy) (9a) The ﬁrst line of minimization (13d) represents a difﬁcult
st
hjot(cx,cy,wct,wst)=Ajxy ccxy +Ajφ wwsctt +fjot (9b) nwocknt+-1c,ownvsket+x1,othpetimnoizna-ltiinoena.rBpeuntailntytehraessttihneglsya,mfeorforthmeasgi(v5ean)
478
Authorized licensed use limited to: UNIVERSITY OF ROCHESTER. Downloaded on September 20,2020 at 15:45:56 UTC from IEEE Xplore.  Restrictions apply. andthuswecanreplaceitwithaconvexsurrogatesimilarto The cost function deﬁnes a set of goal positions that a
(5b). We follow [15] for updating the Lagrange multipliers FWV can take at ﬁnal time t , thus allowing the FWV to
f
λ based on residual of g . The update of λ ,λ are choose a point of convergence on the given path based on
gt t wt θt
derived from our prior work(cid:20)[13] in the follow(cid:21)ing form. trajectory smoothness, obstacle avoidance etc. Note that the
cost function is non-linear with respect to variable γ but
wk+1−cos(θk+1) convex with respect to (cosγ,sinγ). Thus, we follow the
λwt =λwt + wckt+1−sin(θkt+1) (11) process established in the previous section and perform the
st t
λθt =λθt +(θtk+1−arctan2wwskkt++11) (12) cchoastngfuenoctfiovnariisabsluebssewqcγue=ntly(cid:88)corse((cid:122)fγo)rm(cid:20)aunldatew(cid:125)d(cid:124)sγin=thse(cid:21)inf(o(cid:123)γll)o.wTinhge
ct manner.
consensus
The optimizations (13c) and (13d) can be understood as
−
backandforthprojectionbetweenthesetcontainingwct,wst fgoalset(cx,cy,wcγ,wsγ)+ ργ(cid:107) wwcγγ−(cid:20) csoin(cid:21)s((γγ)) (cid:107)22
and θt. Such alternating projections are found to converge t s
even in the non-convex case [16]. Refer to our prior work wγ
+λT c +λ γ (15)
[13] (Fig. 1) for visualization of the projection process. We wγ wγ γ
s
also empirically validate the convergence in Section IV by The cost (15) can now be integrated in Algorithm 1. Two
showing a decrease in consensus residual with iteration. new minimization steps similar to (13c) and (13d) would
Comparisons with SQP:TheAlgorithm1hasafundamen- result for computing wγ,wγ and γ respectively.
tal difference with algorithms like SQP which at the most Tangent Cost: We cancalsso construct a cost to ensure that
basic level also involve solving a sequence of convex QPs. at the point of convergence, the heading angle of the FWV
In the context of optimization (4a)-(4f), SQP would proceed is tangential to the given path. That is,
by Taylor series expansion of g ,hj with respect to φ to
obtain a convex QP. Since, bothttheotse functions are higthly f =(x˙ cosγ+y˙ sinγ)2 =(x˙ wγ+y˙ wγ)2,t=t (16)
tangent t t t c t s f
nonlinear in terms of φ , the obtained QP will hold only in
t Itcanbeseenthatthecost(16)hasthesameformasf .
the vicinity of the expansion point. This in turn, leads to goalset
a requirement of incorporating line-search or so-called trust- IV. SIMULATIONANDBENCHMARKING
regionconstraints(see[11])whichforcesthesolutionateach
Setup: We prototyped the proposed optimizer in Python
iteration to be in the vicinity of the current expansion point.
using either QuadProg [18] or CVXOPT [19] as our QP
Ithnuscoonbttraaisnte,dwaegllionbeaalrliyzevdalihdjotcoanrvoeuxnd(ov(ceor)sφapt,psroinxiφmt)atiaonnd. solver. We also implemented optimization (4a)-(4f) using
SQP method implemented in SciPy-SLSQP [8] and interior-
For g , we did not perform any linearization. Finally, we
t pointmethodimplementedinIPOPT[9]usingAutograd[20]
by-pass the non-convexity of (cosφt,sinφt) through smart tocomputethegradientsofthecostandconstraintfunctions.
reformulations and globally valid convex surrogate (5b). As
All optimizers were run on a 2.60 GHz laptop with 32 GB
a result, Algorithm 1 requires no line search or trust region
RAM, i7-9750H CPU on a single core set up. For each
constraintsandthusthereisnorestrictiononhowbigastep,
benchmarkconsidered,wegenerated11differentvariantsby
the QPs can take towards the optimal solution.
perturbingtheinitialpositions,headingandforwardvelocity.
D. Extension to FWV The planning horizon was 15s for the autonomous driving
benchmarks and 10s for the example involving FWV and
The planar motion of a FWV is governed by the non-
was further discretized into 50 steps.
holonomic motion model presented in (2a). However, the
Benchmark 1: In this benchmark shown in Fig.2(a), the
curvature bounds are bi-afﬁne, in contrast to the afﬁne
ego-vehicle (shown in red) is required to converge behind
form associated with non-holonomic car-like vehicles [17].
theleadervehicle(showninblue)withzerorelativevelocity
Existing works like [17] typically ﬁx forward velocity v of
t whileavoidingthedynamicobstacles(showninblack).This
FWVtoaconstantvaluetoreducebi-afﬁnecurvaturebounds
benchmarkwaschosenbecauseitrequirestheego-vehicleto
to an afﬁne form. However, such an approach reduces the
performovertakingmaneuversandforsomeinitialyposition
spaceoffeasiblemotions.Incontrast,theproposedoptimizer
of the ego-vehicle also entails a lane change action.
does not require such simplifying assumptions as it can
The cost function employed consisted of a cost on the
directly handle the bi-convex form by alternately optimizing
ﬁnalposition(asdeterminedbytheleadervehicle’strajectory
over the linear and angular velocities (see (13a) -(13d)).
in the planning horizon) and smoothness cost consisting of
Goal Set: Consider the following cost function where x ,y
correspond to the center of a circular or a elliptical cpathc p.e..nalties on lateral acceleration (y¨), linear (v¨t) and angular
(φ ) jerk. The relative velocity requirement was modeled
parametrized in terms of arc angle γ as x = x + t
path c as afﬁne equalities on variables c ,c . We also considered
acos(γ),y =y +bsin(γ) v φ
path c additionalafﬁneinequalitiesonvariablesc ,c tomodelthe
x y
lane boundaries.
− −
fgoalset(xt,yt,γ)=(xt xpath)2+(yt ypath)2,t=tf The output trajectories from two different initial positions
⇒ − −
f (c ,c ,γ)=(p c x )2+(p c y )2 are shown in Fig.2(a). Fig2(b) provides an empirical valida-
goalset x y t x path t y path
(14) tionfortheconvergenceofAlgorithm1byshowingdecrease
479
Authorized licensed use limited to: UNIVERSITY OF ROCHESTER. Downloaded on September 20,2020 at 15:45:56 UTC from IEEE Xplore.  Restrictions apply. Algorithm 1 Alternating Minimization for solving (10a)-(10d)
1: Initialize ck,ck, ck,ck,θk.
≤φ v x y t
2: while k maxiter do
Use ckx,cky,ckφ tocompute (xˆt,yˆt,cosφˆt,sinφˆt) andconsequently Ajxy,Ajφ,fjot,Update wckt =cosθtk,wskt =sinθtk.
L ≤ ≤
ckv+1=argmcvin (cv,ckx,cky,ckφ,wckt,wskt),hv(cv) 0,hcurv(cv,ckφ) 0. (13a)
L ≤
ckx+1,cky+1=(cid:20) argcmx,icny (c(cid:21)kv+1,cx,cy,ckφ(cid:20),wckt(cid:21),wskt),hjot(cx,cy,wckt,wskt) 0. (13b)
Update Aj ,Aj,fj using ck+1,ck+1.
− xy φ ot x y
wckt+1,wskt+1=argwcmt,iwnstL(ckv+1,ckx+1,cky+1,ckφ,wct,wst)+ρc(cid:107) wwcstt−csoinsθθtktk (cid:107)22+λwtT (cid:88)wwsctt ,h(cid:34)jot(ckx+1,cky+1,w(cid:35)ct,wst)≤0. (13c)
−
θtk+1,ckφ+1=argθmt,icnφL(ckv+1,ckx+1,cky+1,cφ,wckt+1,wskt+1)+ t ρc(cid:107) wwcksktt++11−csoinsθθtt (cid:107)22+λθt(θt)
θt=(cid:88)ptcφ,hφ(cφ)≤0,hcurv(cφ,ckv+1)≤0.
⇒θtk+1,ckφ+1=argθmt,icnφL(ckv+1,ckx+1,cky+1,cφ,wckt+1,wskt+1)+ t ρc(θt−arctan2wwcskktt++11)2+λθt(θt)
≤ ≤
θt=ptcφ,hφ(cφ) 0,hcurv(cφ,ckv+1) 0. (13d)
3: end while
Convergence Validation
15
10
5
0
0 5 10 15
15
consensus
10 gt
5
0
0 5 10 15
iteration
(a) (b)
Final Position Cost Smoothness Cost Min. of Mean Obstacle Clearance Computation Time
0.20
Proposed, Mean =0.006 10 Proposed 20 2.5 Proposed, Mean =0.085
0.15 SIPcOipPyT-,S MLSeQanP ,= M4e.0an6 2=0.009 8 SIPcOipPyT-SLSQP 15 2.0 SIPcOipPyT-,S MLSeQanP ,= M2e.5an9 6=1.808
[m]0.10 46 [m]10 [s]11..05
Proposed, Mean =22.141
0.05 2 5 Scipy-SLSQP, Mean =20.547 0.5
IPOPT, Mean =8.816
0.00 0 0 0.0
angular jerk linear jerk lateral acc. Sum
(c) (d) (e) (f)
Fig. 2. (a) The ego-vehicle (red rectangle) needs to converge behind the leader vehicle (blue rectangle) with zero relative velocity while avoiding the
dynamicobstacles(blackrectangles).Theinitialpositionsofthevehiclesareshowninthelightershadewhiletheboldvariantsrepresenttheﬁnalposition.
Theﬁnalpositionoftheego-vehicleisonlyshownwithrespecttothetrajectoryobtainedwiththeproposedoptimizer.Thetopandbottomplotsshowthe
(cid:107) (cid:107)
trajectoriesfortwoinitialpositionsoftheego-vehicle.(b)Residualoftheconsensusand g withiterationsforthetwotrajectoriesin(a)obtainedwith
t 2
theproposedoptimizer.(c)-(f)Quantitativecompariso.n..sbetweentheproposedoptimizer,SciPy-SLSQPandIPOPTacrossdifferentmetrics.Notelateral
accelerationisy¨t,linearandangularjerka(cid:107)rev¨(cid:107)t and φt respectively.
in residual of consensus term and g 2 with iterations. The Benchmark 2: This benchmark is shown in Fig.3(a) and is
t 2
quantitative results are summarized in Fig.2(c)-2(f). Both similartooneshowninFig.2(a)withthesamecostfunction.
Scipy-SLSQP and the proposed optimizer produced similar The difference here is that the ego-vehicle is required to
ﬁnal position and smoothness cost which were signiﬁcantly converge to the front of the leader vehicle with zero relative
better than those resulting from IPOPT. both SciPy-SLSQP velocity. The results are summarized in Fig.3(a)-(3(f)). The
and IPOPT produces trajectories in the same homoptopy proposed optimizer again outperforms both Scipy-SLSQP
which went between the obstacles. In contrast, the trajecto- and IPOPT computation time by a factor of almost 19 and
riesresultingfromtheproposedoptimizerconsistentlychose 16 respectively. Note that the increased computation time
a homotopy with higher clearance from dynamic obstacles. in this case with respect to benchmark 1 is due to the fact
This is further validated in Fig.2(e) which shows the min- that the ego-vehicle needs to consider collision avoidance
imum of the mean obstacle clearance observed across dif- with the leader vehicle while overtaking it. Thus, there are
ferent trajectories. Fig.2(f) shows our most important result: effectively three dynamic obstacles in this benchmark.
the computation time of the proposed trajectory optimizer
Benchmark 3: This benchmark is shown in Fig.4(a) and
is more than 20 and 30 times less than SciPy-SLSQP and
requires an FWV to converge to a circular path (shown in
IPOPTrespectively.Notethatthetimingresultsforthelatter
magenta) while avoiding circular obstacles. As common in
two optimizer do not include the Autograd overhead.
existing works, we also model the footprint of the FWV
480
Authorized licensed use limited to: UNIVERSITY OF ROCHESTER. Downloaded on September 20,2020 at 15:45:56 UTC from IEEE Xplore.  Restrictions apply. Convergence Validation
15
10
5
0
0 5 10 15
15
consensus
10 gt
5
0
0 5 10 15
iteration
(a) (b)
Final Position Cost Smoothness Cost Min. of Mean Obstacle Clearance Computation Time
0.200
0.175 Proposed, Mean =0.009 12 Proposed 20 3.5 PSrcoippyo-sSeLdS,Q MPe, aMne =an0 .=1938.716
0.150 Scipy-SLSQP, Mean =0.049 10 Scipy-SLSQP 3.0 IPOPT, Mean =3.394
[m]000...011702505 IPOPT, Mean =8.521 68 IPOPT [m]1105 [s]122...505
0.050 4 5 PSrcoippyo-sSeLdS,Q MPe, aMne =an2 2=.12401.547 1.0
0.025 2 IPOPT, Mean =6.736 0.5
0.000 0angular jerklinear jerk lateral acc. Sum 0 0.0
(c) (d) (e) (f)
Fig.3. (a)SimilarbenchmarkasFig.3withthesameplottingconventions.Thedifferencehereisthattheego-vehicleneedstoconvergeinfrontofthe
leader vehicle with zero relative velocity. (b) Convergence validation for the two trajectories shown in (a) obtained with the proposed optimizer. (c)-(f)
Quantitativecomparisonsbetweentheproposedoptimizer,SciPy-SLSQPandIPOPTacrossdifferentmetrics.
Proposed
SciPy-SLSQP Linear and Angular velocity Convergence Validation
IPOPT 18
150 150 150 50
m/s16 Proposed 0
100 100 100 SciPy-SLSQP 0 10 20 30
y[m] 50 50 50 01.54 0 2 IPOP4T 6 8 10 50
0
0 0 0 rad/s 0.0 50 0 10 20 consen3s0us
gt
−50 −50 −50 −0.5 0
0 50 100 0 50 100 0 50 100 0 2 4 6 8 10 0 10 20 30
x[m] x[m] x[m] time [s] iteration
(a) (b) (c)
Final Position Cost Smoothness Cost Min. of Mean Obstacle Clearance Computation Time
00..0180 PSIPrcOoiPpPyoT-s,S eMLdSe,Q aMnPe,  =aMn0e .=a1n10 2.=0001.001 111...024 PSIPrcOoiPpPyoT-sSeLdSQP 110200 11..2550 PSIPrcOoiPpPyoT-s,S eMLdSe,Q aMnPe,  =aMn0e .=a8n70 6.=0819.641
[m]0.06 00..68 [m] 6800 [s]01..7050
0.04 0.4 40 PSrcoippyo-sSeLdS,Q MPe, aMne =an1 3=11.22486.366 0.50
0.02 0.2 20 IPOPT, Mean =107.473 0.25
0.00 0.0angular jerk linear jerk Sum 0 0.00
(d) (e) (f) (g)
Fig. 4. (a) FWV starting from an initial point (shown in cyan) needs to converge to a circular path (shown in magenta) with a heading tangential to
thepathandwhileavoidingthestaticobstacles(showninblack).(b)LinearandAngularvelocityproﬁlesobtainedforthethirdtrajectoryshownin(a)
with different optimizers. (c) Convergence validation for the three trajectories shown in (a) obtained with the proposed optimizer. (d)-(g) Quantitative
comparisonsacrossdifferentmetrics.
as a circle. The cost function employed in this benchmark in this case, by a factor of 18 and 10 respectively.
consisted of f and f deﬁned in (14) and (16)
goalset tangent V. DISCUSSIONSANDFUTUREWORK
respectively and smoothness cost in the .f..orm of l2 norm In this paper, we showed that non-holonomic trajectory
penalties on linear (v¨) and angular jerk (φ ).
t t optimization has some niche mathematical structures which
The output trajectories for three different initial heading havebeenoverlookedintheexistingliterature.Weproposed
proﬁleareshowninFig.4(a).Fig.4(b)veriﬁesthesmoothness some intelligent reformulations around these structures and
in the linear and angular velocity proﬁles for the third reduced non-holonomic trajectory optimization to a problem
trajectory shown in Fig.4(a). Fig.4(c) shows the progress of of solving a sequence of globally valid convex QPs. We
the consensus and non-holonomic constraint residuals with performed extensive comparisons with state of the art open-
iteration for the three trajectories shown in Fig.4(a). The source optimizers and showed either similar or improved
quantitative results are summarized in Fig.4(d)-4(g). IPOPT performanceintermsofachievedoptimalcostbutwithmore
performed much better in this benchmark in terms of ﬁnal than 20x reduction in computation time.
position and smoothness cost although still worse than the The proposed optimizer can be immediately extended to
proposed optimizer and the SciPy-SLSQP. Just like previous accommodate motion model of cars with side-slip or tyre
benchmarks, we observed slightly higher obstacle clearance force dynamics since they have the same structure of being
for the trajectories obtained from the proposed optimizer bi-afﬁne in the space of velocity and cosine and sine of
(Fig.4(f)). The computation times (Fig.4(g)) again show the heading,sideslipandsteeringangles[21].Similarstructures
proposedoptimizeroutperformingSciPy-SLSQPandIPOPT, can be also be found in 3D motion model for FWV [17].
481
Authorized licensed use limited to: UNIVERSITY OF ROCHESTER. Downloaded on September 20,2020 at 15:45:56 UTC from IEEE Xplore.  Restrictions apply. REFERENCES
[1] D. Mellinger and V. Kumar, “Minimum snap trajectory generation
and control for quadrotors,” in 2011 IEEE International Conference
onRoboticsandAutomation. IEEE,2011,pp.2520–2525.
[2] T.LippandS.Boyd,“Variationsandextensionoftheconvex–concave
procedure,”OptimizationandEngineering,vol.17,no.2,pp.263–287,
2016.
[3] F. Gao and S. Shen, “Quadrotor trajectory generation in dynamic
environments using semi-deﬁnite relaxation on nonconvex qcqp,” in
2017 IEEE International Conference on Robotics and Automation
(ICRA). IEEE,2017,pp.6354–6361.
[4] W. Schwarting, J. Alonso-Mora, L. Pauli, S. Karaman, and D. Rus,
“Parallel autonomy in automated vehicles: Safe motion generation
with minimal intervention,” in 2017 IEEE International Conference
onRoboticsandAutomation(ICRA). IEEE,2017,pp.1928–1935.
[5] J.David,R.Valencia,R.Philippsen,P.Bosshard,andK.Iagnemma,
“Gradient based path optimization method for autonomous driving,”
in2017IEEE/RSJInternationalConferenceonIntelligentRobotsand
Systems(IROS). IEEE,2017,pp.4501–4508.
[6] K. Yang, S. Sukkarieh, and Y. Kang, “Adaptive nonlinear model
predictive path tracking control for a ﬁxed-wing unmanned aerial
vehicle,” in AIAA Guidance, Navigation, and Control Conference,
2009,p.5622.
[7] C.Chen,Y.He,C.Bu,J.Han,andX.Zhang,“Quarticbéziercurve
based trajectory generation for autonomous vehicles with curvature
and velocity constraints,” in 2014 IEEE International Conference on
RoboticsandAutomation(ICRA). IEEE,2014,pp.6108–6113.
[8] E.Jones,T.Oliphant,P.Petersonetal.,“Scipy:Opensourcescientiﬁc
toolsforpython,”2001.
[9] A.WächterandL.T.Biegler,“Ontheimplementationofaninterior-
point ﬁlter line-search algorithm for large-scale nonlinear program-
ming,”Mathematicalprogramming,vol.106,no.1,pp.25–57,2006.
[10] Q. Li, Z. Zhu, and G. Tang, “Alternating minimizations converge
to second-order optimal solutions,” in International Conference on
MachineLearning,2019,pp.3935–3943.
[11] J.Schulman,Y.Duan,J.Ho,A.Lee,I.Awwal,H.Bradlow,J.Pan,
S.Patil,K.Goldberg,andP.Abbeel,“Motionplanningwithsequential
convexoptimizationandconvexcollisionchecking,”TheInternational
JournalofRoboticsResearch,vol.33,no.9,pp.1251–1270,2014.
[12] P.Jain,P.Karetal.,“Non-convexoptimizationformachinelearning,”
(cid:13)
FoundationsandTrendsR inMachineLearning,vol.10,no.3-4,pp.
142–336,2017.
[13] A.K.Singh,R.Ghabcheloo,A.Muller,andH.Pandya,“Combining
method of alternating projections and augmented lagrangian for task
constrainedtrajectoryoptimization,”in2018IEEE/RSJInternational
ConferenceonIntelligentRobotsandSystems(IROS). IEEE,2018,
pp.7568–7575.
[14] A. K. Singh, A. Ahonen, R. Ghabcheloo, and A. Muller, “Intro-
ducing multi-convexity in path constrained trajectory optimization
for mobile manipulators,” in To appear at 2020 IEEE European
ControlConference(ECC),relatedversionavailableatarXivpreprint
arXiv:1904.09780,2020.
[15] S. Boyd, N. Parikh, E. Chu, B. Peleato, J. Eckstein et al., “Dis-
tributed optimization and statistical learning via the alternating di-
(cid:13)
rectionmethodofmultipliers,”FoundationsandTrendsR inMachine
learning,vol.3,no.1,pp.1–122,2011.
[16] A. S. Lewis, D. R. Luke, and J. Malick, “Local linear convergence
for alternating and averaged nonconvex projections,” Foundations of
ComputationalMathematics,vol.9,no.4,pp.485–513,2009.
[17] M. Owen, R. W. Beard, and T. W. McLain, “Implementing dubins
airplane paths on ﬁxed-wing uavs,” Handbook of Unmanned Aerial
Vehicles,pp.1677–1701,2015.
[18] D. Goldfarb and A. Idnani, “A numerically stable dual method
for solving strictly convex quadratic programs,” Mathematical
programming, vol. 27, no. 1, pp. 1–33, 1983. [Online]. Available:
https://pypi.org/project/quadprog/
[19] L. Vandenberghe, “The cvxopt linear and quadratic cone pro-
gramsolvers,”Online:http://cvxopt.org/documentation/coneprog.pdf,
2010.
[20] D.Maclaurin,D.Duvenaud,andR.P.Adams,“Autograd:Effortless
gradientsinnumpy,”inICML2015AutoMLWorkshop,vol.238,2015.
[21] J.Kong,M.Pfeiffer,G.Schildbach,andF.Borrelli,“Kinematicand
dynamic vehicle models for autonomous driving control design,” in
2015 IEEE Intelligent Vehicles Symposium (IV). IEEE, 2015, pp.
1094–1099.
482
Authorized licensed use limited to: UNIVERSITY OF ROCHESTER. Downloaded on September 20,2020 at 15:45:56 UTC from IEEE Xplore.  Restrictions apply. 