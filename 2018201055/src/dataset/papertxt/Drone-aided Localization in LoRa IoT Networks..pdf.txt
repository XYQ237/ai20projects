2020 IEEE International Conference on Robotics and Automation (ICRA)
31 May - 31 August, 2020. Paris, France
Navigating Discrete Difference Equation Governed WMR
by Virtual Linear Leader Guided HMPC
Chao Huang, Xin Chen, Enyi Tang, Mengda He, Lei Bu, Shengchao Qin, Yifeng Zeng
Abstract—In this paper, we revisit model predictive con- tree (anytime RRT) and model predictive control (MPC).
trol (MPC) for the classical wheeled mobile robot (WMR) Anytime RRT is the online version of RRT [8], [9] for
navigation problem. We prove that the reachable set based
trace planning. Along with the trace techniques [5], [6], it
hierarchical MPC (HMPC), a state-of-the-art MPC, cannot
can be used to solve robot navigation problem. However,
handle WMR navigation in theory due to the non-existence of
non-triviallinearsystemwithanunder-approximatereachable regardless of the current result that even the off-line RRT
set of WMR. Nevertheless, we propose a virtual linear leader cannot ensure the probabilistic stability for nonlinear robots
guidedMPC(VLL-MPC)toenableHMPCstructure.Different with common settings [10], there is currently no theoretical
from current HMPCs, we use a virtual linear system with an
stability guarantee on anytime RRT.
under-approximate path set rather than the traditional trace
MPC is one of the main stream methodologies in robotics
set to guide the WMR. We provide a valid construction of
the virtual linear leader. We prove the stability of VLL-MPC, community for the navigation/control problem of various
and discuss its complexity. In the experiment, we demonstrate systems [11], [12], [13], [14], [15], [16]. Its main idea is
the advantage of VLL-MPC empirically by comparing it with at each instant t, to predict the behavior of a system, over
NMPC, LMPC and anytime RRT* in several scenarios.
ﬁnite future steps, namely, prediction horizon, by solving
a programming problem based on the dynamic model and
I. INTRODUCTION
collision avoidance speciﬁcation, and only apply the ﬁrst
The wheeled mobile robot (WMR) navigation problem
predicted action. This procedure will repeat at the next
considered in this paper is to drive a nonlinear dynamical
control instant until a certain convergent criteria is met.
WMR governed by a discrete difference equation, from its
Basic MPC approach for WMR is to directly encode all the
initialstatetothegoalstatebyon-linereal-timelytuningits
nonlinear constraints (NMPC) and jointly generate the trace
control input, in a continuous state and input space. When
and inputs [17]. Due to the intrinsic complexity of nonlinear
there is no available reference path, a successful navigation
programming, NMPC is time consuming.
mustensuretheWMRcanconvergetothegoalstate,referred
In recent years, hierarchical MPC (HMPC) as one of
to as stability. Meanwhile, the real-time nature requires the
the advanced MPC, receives more attention. HMPCs adopt
computationaspromptlyaspossible,referredtoasefﬁciency.
a two-level structure. In the upper level, a simple linear
An intuitive solution to the problem is to combine the
dynamicsystemisusedtohelpplanthetracebylinearMPC,
methods of trace planning and trace tracking as a whole.
and then the original system tries to follow the trace in the
Unfortunately, the distinctive nature of the problem prevents
lower level. Such hierarchical treatment has shown a great
many mutual techniques from being applied. Due to the
advantage on efﬁciency for linear/piecewise afﬁne systems
continuity of state space, traditional heuristic-search based
[18], [19], [20]. The key of HMPC is to guarantee the linear
techniques designed for the planning problem of discrete
system has a “smaller” state reachable set than the original
space, such as A* like methods [1], [2] are not applicable.
system, such that any trace planned by the linear system is
The off-line planning [3], [4] and tracking techniques [5],
achievable for the original system. It is known as the under-
[6] cannot satisfy the efﬁciency requirement enforced by
approximation problem [21], [22].
the online planning. Besides, the approaches for systems
However, in this paper, we show that the traditional
of ordinary differential equations (ODE) [7] are unable to
state reachable-set based HMPCs are inapplicable for WMR
handle a WMR as the property of universal trace following
navigation due to the nonlinearity introduced by the state
no longer holds for discrete systems.
variableθ,denotingthedirection.Ononehand,weprovethat
Current approaches solve this problem by extending the
thereexistsoneandonlyonetriviallinearsystemthathasan
off-line planning and tracking to the online, which mainly
under-approximate reachable set of the WMR, but can only
fall into two categories: anytime rapidly exploring random
steer in place (see Theorem 1). On the other hand, simply
linearizing the WMR dynamic to make classical HMPCs
Chao Huang, Xin Chen, Enyi Tang and Lei Bu are with the
State Key Laboratory for Novel Software Technology, Nanjing Uni- (LMPC) applicable will inevitably introduce approximation
v{ersity, Nanjing, Jiangsu, China. c}haohuang@seg.nju.edu.cn, errorasadisturbanceandisunabletoensurestabilityeither.
chenxin,eytang,bulei @nju.edu.cn.
In order to leverage the high efﬁciency of HMPC, a
Chao Huang is also with the Department of Electrical Engineering and
ComputerScience,NorthwesternUniversity,Evanston,IL,USA. novelVirtualLinearLeaderguidedModelPredictiveControl
Mengda He, Shengchao Qin and Yifeng Zeng are with the School of (VLL-MPC) is proposed for WMR navigation. In the prob-
Computing,TeessideUniversity,UK.ShengchaoQinisalsowithShenzhen
{ } lem, the target state consists of both the target position and
University. m.he, s.qin, y.zeng @tees.ac.uk.
Correspondingauthor:XinChen the target direction. Following the philosophy of successive
978-1-7281-7395-5/20/$31.00 ©2020 IEEE 151
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 10:52:55 UTC from IEEE Xplore.  Restrictions apply. approaching, it is possible to ﬁrstly drive a WMR to a point [x ,y ]:
i i
very near to the target position, and then guide it to the q (t+1)=f (q (t)), i=1,··· ,n. (4)
i··· i i
ﬁnal state by setting the speed and the angular velocity Let q = [q , ,q ]. We use the following compact form
e 1 n
properly (see Proposition 1). As a result, the navigation to represent the environment dynamic:
problemcanbesafelyconvertedintotheproblemofﬁndinga q (t+1)=f (q (t)); (5)
e e e
path convergent to the ﬁnal position. The advantage coming ThedistancebetweentheWMRandanyobstacleshouldnot
from such conversion is that the direction variable θ can be over a given dsafe to avoid collision:
be safely ignored in the planning stage such that it is easy (cid:107)[x,y]−[xi,yi](cid:107)∞ ≥dsafe, i=1,··· ,n. (6)
to build a linear system (VLL) under-approximating the
Subsequently we formulate the WMR navigation problem
reachable set of the WMR. As the key step of VLL-MPC,
based on the above model of WMR and environment:
the construction of the VLL for the dynamic of WMR
is elaborated whose validity is strictly proved. Beneﬁting Problem 1 (WMR Navigation). Given a WMR W, where
from the HMPC structure, VLL-MPC’s stability and high • the dynamic model is Equation (1) and its input con-
efﬁciency can be theoretically assured. straint described as Constraint (2);
In the paper, we make the following contributions: • an initial state is q(0)=[x(0),y(0),θ(t)];
(cid:48) (cid:48) (cid:48) (cid:48)
• We prove that reachable set based HMPCs cannot • a goal state is q =[x,y ,θ ],
handle WMR navigation in theory; an environment E, where
• We propose a novel VLL-MPC to enable the HMPC • the dynamic model is Equation (5);
framework for the WMR navigation and give a con- • an initial state is q (0);
e
struction of the virtual linear leader, which is the core the collision avoidance speciﬁcation described as Con-
of VLL-MPC; straint (6) and a convergence error bound , the WMR
• We give a sufﬁcient condition to theoretically ensure navigation problem is to ﬁnd a control strategy to determine
the stability of VLL-MPC and discuss the complexity; a path ρ (q ) by on-line generating a control sequence
• We demonstrate the performance of VLL-MPC in sev- {u(t)}∞ Wsuc0h that W can reach B (cid:48)() without collision,
t=0 q
eral scenarios and show its advantages empirically by a where B (r) denotes a ball around x with radius r.
x
comparison with NMPC, LMPC and anytime RRT*.
Twokeypropertiesstability[26]andefﬁciencyaredeﬁned
II. PROBLEMFORMULATION as follows.
A WMR follows the discrete dynamic model [23], [5]: Deﬁnition 1 (Stability). A control scheme is stable for a
x(t+1)=x(t)+v(t)cosθ(t)∆T WMRnavigationproblem1,iffstartingfromtheinitialstate
y(t+1)=y(t)+v(t)sinθ(t)∆T q(0), the path ρ (q ) of computed by the control scheme
W 0
θ(t+1)=θ(t)+ω(t)∆T reaches B (cid:48)().
q
where x and y denote the position under Cartesian coor- Deﬁnition2(Efﬁciency). Theefﬁciencyofanon-linecontrol
dinate, θ denote the direction, v and ω are the forward
scheme is deﬁned as its average computation time at each
and steering velocity respectively. This model can be also
represented in a compact form: sampling instant.
q(t+1)=f(q(t),u(t)), (1) III. REVISITMPCSFORWMRNAVIGATION
where q = [x,y,θ] is the state variable, u = [v,ω] is the
Let us ﬁrst revisit MPCs, including NMPC and the state-
inputvariable,tdenotesthet-thsamplinginstantand∆T is
the sampling period. Due to the limit of the engine power, of-the-art HMPC for WMR navigation from an uniﬁed
the velocity is bounded by the input constraint: perspective of reachable set [27], [28] to motivate our idea.
∈ (cid:44)| |≤
u U v Vbound. (2) Deﬁnition 3 (Reachable set). The reachable set of W from
The WMR’s behavior is either deﬁned by a trace or a path q after the next sampling period is deﬁned as Reach (q)=
{ (cid:48)|∃ ∈ (cid:48) } W ⊆
[24], [25].{A tra}ce of W, denoted as trW(q), is a ﬁnite state q u U,q = f(q,u) . Specially, a set ReachW(q)
sequence q(t) tf satisfying Constraint (2), derived from Reach (q) is called an under-approximate reachable set.
t=0 W
f, while q(0) = q and t is an arbitrary natural number. A
f In NMPC, at each sampling instant t, an optimization
path ρ (q) only considers the position part of a trace, i.e.
{ W } problem needs to be solved online to predict the behavior
[x(t),y(t)] tf . Tr (q) and P (q) denote the set of all
t=0 W W of the robot, which involves the robot dynamic and all
traces and paths from q, respectively.
the relevant constraints. Figure 1 shows an example of
Such a robot needs to navigate in a dynamical environ-
ment, including both moving and stationary obstacles. We how NMPC works at each sampling instant t. In NMPC,
consider the linear convex space, that is, the overall state the original nonlinear dynamic is directly encoded in the
space of the environment can be described as a polytope Q: optimizationproblem,whichindicatestheexactreachableset
(irregular black shape) is implicitly considered. The yielded
∈ (cid:44) × −
q Q P [ π,π]. (3) nonlinear programming makes NMPC time consuming.
where P represents the position space for [x,y].
Weassumethattherearenobstacleswithlineardynamics, Remark 1. Notably in practice, rather than computing the
and the state q of the i-th obstacles include its position reachable set, NMPC only ﬁnds a (optimal) feasible point,
i
152
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 10:52:55 UTC from IEEE Xplore.  Restrictions apply. 𝑞 𝑡(cid:3397)1
(cid:3046)
𝑣 𝑡 ∆𝑇
𝜃 𝑡(cid:3397)1
𝜃 𝑡(cid:3398)1
𝜃 𝑡 (cid:3404)𝜃 𝑡(cid:3398)1 (cid:3397)𝜔 𝑡(cid:3398)1∆𝑇
𝑞 𝑡(cid:3398)1
(cid:3046)
𝑡 1|𝑡 2|𝑡 3|𝑡
𝑞 𝑡
(cid:3046)
Fig. 1: Methodologies of NMPC and LMPC at sampling instant t:
Thebluerectangleisthestatespace.Blackandredshaperepresent Fig. 2: Relation between the position and input variables: The
the exact and linear-approximate reachable set. The purple points position of the WMR at t+1 is determined by the direction θ(t)
−
denote the predicted trace in the next three steps. The symbol andthelinearvelocityv(t),whileθ(t)isdeterminedbyω(t 1).
| −
it,i=1,2,3 denotes the i-th step predicted at t. Thus, the position at t+1 is determined by v(t) and ω(t 1).
which has lower computation complexity. Here, we leverage makes the robot system unpredictable (See Figure 1).
reachable set to provide a mathematical intuition of NMPC.
IV. VLL-MPC
In Section V, we will elaborate the computation complexity.
Our idea is based on an interesting observation that once
A naive idea is to explore if we can ﬁnd a linear system
WMR’s position is very closed to the goal position, we can
with an under-approximate reachable set of the WMR, such
that the WMR can reach every state planned within the always let the overall state also close to the goal state:
under-approximate reachable set. Then such linear system (cid:107) − (cid:48) (cid:48) (cid:107)≤
can be used to plan the trace in the upper level by MPC, Proposition1. If [x(t),y(t)] [x,y ] ,thenletv(t)=
(cid:48)− (cid:107) − (cid:48)(cid:107)≤
while the actual input of the WMR is then computed to 0,ω(t)=(θ θ(t))/∆T, we have q(t+1) q .
drive the WMR to follow the trace. This idea is also
known as hierarchical MPC (HMPC) and adopted in recent Thustheoriginalproblemcanbeconvertedintodetermin-
works for linear/piecewise afﬁne systems [18], [19], [20]. ing a convergent path.
Intuitively, the system that only does pivot steering meets Based on Proposition 1, we propose a virtual linear
such requirement:
leader based model predictive control (VLL-MPC) scheme
x(t+1)=x(t), y(t+1)=y(t), θ(t+1)=A3θ(t)+u3. to enable HMPC structure. We construct a virtual robot R
However, it cannot be used for trace planning and thus we with state variable q , which has linear dynamic and the
R
callittrivial.Unfortunately,weﬁndthatthereexistsnonon- smaller path set from any state q than the WMR W, that is
⊆
trivial linear under-approximation for WMR: P (q) P (q). We refer to R as a virtual linear leader.
R W
Then following the HMPC manner, we online plan the path
Theorem 1. For a WMR with dynamic model (1) and input
based on the dynamic of R by linear MPC. With a larger
constraint (2), there exists no linear system with an under-
path set, the WMR is able to strictly follow the planned
approximate reachable set, except for the trivial one. (cid:48)
path. Thus, we can make W converge to the goal state q by
(cid:48) (cid:48) (cid:48)
Proof. Assume there exists such a system and WLOG, its lettingR convergetoq =[x,y ].Inthefollowing,weﬁrst
dynamic is: introduce the constructRion of the virtual linear leader. Then
x(t+1)=A x(t)+u , y(t+1)=A y(t)+u , the detailed VLL-MPC will be given.
1 1 2 2
θ(t+1)=A θ(t)+u .
3 3
A. Construct a Virtual Linear Leader
where A and u are the coefﬁcient and input for each
i i
dimension respectively. Consider the special case q(t) = ObservingthedynamicofW asEquation(1),wecanﬁnd
[0,0,0]. Recall the dynamic of WMR, we know thatthepositionatinstantt+1isdeter−minedbytheforward
ToRemaceheWt t(hqe(tu))nd=er[-−aVppboruondx∆imTa,t−ioVnbournedq∆uTir]em×e{n0t},×we[−hπa,vπe]. vmeoloticviatytesv(uts)taoncdosntseteruricntgavveilrotuciatlyliωn(etarl1e)ad(eSreReFaisguforello2w).sI:t
x(t+1)=x(t)+v (t)∆T, y(t+1)=y(t)+v (t)∆T,
0=y(t+1)=A y(t)+u =u 1 2
2 2 2 or in a compact form:
Similarly, when q(t)=[0,0,π/2], we can obtain that u =
1 q (t+1)=f (q (t),u (t)), (7)
0. Thus this system is trivial. R R R R
where q =[x,y] is the state, u =[v ,v ] is the input. The
R R 1 2
input constraint is: √
We may simply linearize the nonlinear WMR dynamic
and use the linear dynamic for planning to enable HMPC | | | |≤ 2 (8)
structure, ignoring the requirement of under-approximation. v1 , v2 2 Vbound, v1(0)=v2(0)=0.
Now we point out the validity of our construction R.
It will lead to the linear approximate reachable set with the
linearizationerror(redpolytope).Todifferitfromthetypical Theorem 2. For a WMR W with the dynamic model (1)
HMPC, we name it LMPC. However, such linearization is and the input constraint (2), and the virtual linear leader
preciseonlylocallyaroundthegivenpoint.Sinceonecannot R with the dynamic model (7) and the input constraint (8),
∀ ∈
“predict” the linearization of the system at future steps, the q(0) = [x(0),y(0),θ(0)] Q, let q (0) = [x(0),y(0)],
⊆ R
linearization error will inevitably accumulate over time and then we have P (q (0)) P (q(0)).
R R W
153
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 10:52:55 UTC from IEEE Xplore.  Restrictions apply. Proof. Given any path Computetheinput:Thecontrollerthenderivestheinputof
whρeRr(eqRt(cid:48)(0is))th=e{t[exr(m0)in,ya(cid:112)(l0i)n],st·a·n·t,.[xL(ett(cid:48)),y(t(cid:48))]}∈PR(q(0)), tRh.eTWhaMtiRs,Wcombpasueteduo(nt)th=e [svta(tte),qωR((tt)]+ac1c)oarnddingqRto(tth+e2s)taotef
∆x(t)(cid:44)x(t+1)−x(t), ∆y(t)(cid:44)y(t+1)−y(t), qR(t+1) and qR(t+2) by (9)and applyit on W by (1)such
(cid:44) thatW reachesq(t+1),where[x(t+1),y(t+1)]=q (t+1).
∆D(t) (∆x(t))2+(∆y(t))2, R
This procedure will be repeated at the next sampling
∆y(t+1) (cid:54)
γ(t+1)=arcsin , if ∆D(t+1)=0. instant t+1 based on until the q(t) meets the convergence
∆D(t+1)
We construct the input sequence of W as criteria .
··· (cid:48)− (cid:48)−
µ=[v(0),ω(0)], ,[v(t 1),ω(t 1)], Remark 3. Note that an obstacle here can be either uncon-
where  trollable (e.g. a building) or controllable (e.g. a robot with
v(t)=∆D(t)/∆T, t=0,··· ,t(cid:48)−1 linear dynamics). Specially, when handling a controllable
(cid:48)− robotobstacle,ourapproachcanbenaturallyintegratedwith
0(γ,(t+1)−θ(t))/∆T, ∆∆xD((tt++11))≥=00,,tt<<tt(cid:48)−11 (9) existing distributed MPC schemes [18], [33].
ω(t)= − − (cid:48)−
(π γ(t+1) θ(t))/∆T, ∆x(t+1)<0,t<t 1
(cid:48)− (cid:48)− (cid:48)− V. ALGORITHMANALYSIS
(θ θ(t 1))/∆T, t=t 1
It is easy to check that v(t) is valid in terms of Constraint [Stability] Theorem 2 ensures that the path planned based
(2) and the path ρ (q(0)) of W generated by µ equals onRcanbeachievedbyW.ThusthestabilityofVLL-MPC
W
ρ (q (0)). is determined by the linear MPC law (10), (11).
R R
Remark 2. Note that ω(t(cid:48) − 1) does not affect the es- Lemma 1. VLL-MPC scheme stabilizes the WMR W iff the
tablishment of Theorem 2, thus can be arbitrary. However, MPC law (10), (11) stabilizes the virtual linear leader R.
(cid:48)
when q (t) approaches the goal position, according to
R (cid:48)− (cid:48) InthetheoryoflinearMPC,theterminalconstraintsetand
Proposition 1, our assignment of ω(t 1) can let θ(t) be
costfunctionmethodsarewidelyusedtoensurethestability
the goal direction.
by properly choosing its stable parameters, a terminal cost
P
B. Control Scheme lH·, a terminal constraint set f and a controller function
κ() [26], [29], [30]. We adopt the strategy of parameter
As indicated by Figure 2 and Equation (9), W’s input at t conﬁguration in [29] and give the following theorem:
is computed based on the states of R at both t+1 and t+2,
thus we need to compute the planned path two steps ahead, Theorem 3. ∀H ∈N+, c∈R+, such that P ={q(cid:48) }, then
f R
which is signiﬁcantly different from the current HMPC. the VLL-MPC scheme stabilizes the WMR W.
In detail, at each sampling instant t, the WMR W knows
Proof. The MPC law (10), (11) stabilizes the virtual linear
its current state q(t), while the virtual linear robot R knows
leader R with this parameter conﬁguration [29]. According
its state q (t + 1). the control scheme consists of two
R to Lemma 1, it is equivalent to that VLL-MPC scheme
successive steps:
Compute the planned state at t+2: The controller tries to stabilizes the WMR W.
(cid:88)(cid:13) (cid:13)
plan a goal state q(cid:13) (t+2) for R(cid:13)at t+2 by linear MPC:
R [Complexity] Observe the control scheme of VLL-MPC.
−
 H 1 | − (cid:48) | Theoverallcomputationconsistsofsolvingtheoptimization
q˜Rq|(mHRi(|ntk+|1t−)+k1=|)0=qfR|R≤((kq√Rt+(k1−)1|qtR+1∞),√u+RlH(k(−qR1(|tH+1t+))1,≤)1)≤≤k≤H, pEorfqouboalpteiemornat(i1(o90n))s,aisnwdahncicoehmlepmmueetiannntgasrtyhthefauitnnpccutoitmon(p9u)w.tiiIntthgisﬁEoxqbeudvaitoniuousnmtbh(9ear)t
s.t. qquRR((tk(+k|tk++111)t)∈+=Q1f),(q1[≤(2t2k+V≤kbHo)u)n,,d∆1T≤,k2≤2VHb,ound∆T], 1 k H, tVakLeLs-McoPnCstasncthetmimee.isTdheutse,rmthineedtimbey cthoemoppletximityizaotifonov(e1r0a)ll.
(cid:107)e | −e e| (cid:107) ≥ ≤ ≤ ≤ ≤ Basedonthecurrentworks,weshowtheadvantageofVLL-
qR(k|t+1)∈Pqi(kt+1) |∞ dsafe, 1 i n, 1 k H, MPC on efﬁciency compared with NMPC in theory by the
q (H t+1) , q (0t+1)=q (t+1).
R f R R (10) following conclusion on complexity.
· |
where H is the prediction horizon, the notation ()(k t+1)
denotes the predictive value at the (t+1+k)-th collaboration Theorem 4. NMPC is NP-hard. VLL-MPC is NP-complete
inst·a·n·t compu|ted at time t + 1, q˜(H|t + 1) (cid:44) qR(1|t + in general. Specially, VLL-MPC is of polynomial time if no
1), ,q (H t + 1) denotes the decision variables, and obstacle exists.
R| (cid:44) (cid:107) | − (cid:48)(cid:107)
lH(qR(H t+1)) c qR(H t+1) q P∞ is the terminal Proof. NMPC needs to solve a nonlinear programming
cost and c is an user-dPeﬁned coefﬁcient. f is the terminal
constr∗ain|t set. lH an∗d f| are both used to ensure stability. (NLP). It has been shown in [31] that solving a NLP with
Let qR(1t+1),...∗,qR|(H t+1) denote the optimal solution. quadratic objective and non-convex constraints is NP-hard.
Theﬁrstsampleq (1t+1)willbeusedasthedesiredstate In general, the optimization problem (10) is a mixed integer
R
qR(t+2) for R at the instant t+2: programming (MILP), which is NP-complete. If there is no
∗ |
q (t+2)=q (1t+1). (11) obstacle,(10)degeneratestoalinearprogramming,whichis
R R
The VLL R then moves to q (t+2). of polynomial time.
R
154
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 10:52:55 UTC from IEEE Xplore.  Restrictions apply. 50 50 50 50
45 45 45 45
40 40 40 40
35 35 35 35
30 30 30 30
25 25 25 25
20 20 20 20
15 15 15 15
10 10 10 10
5 5 5 5
00 10 20 30 40 50 00 10 20 30 40 50 00 10 20 30 40 50 00 10 20 30 40 50
(a)FreeSpace:VLL-MPC (b)FreeSpace:NMPC (c)FreeSpace:LMPC (d)FreeSpace:AnytimeRRT*
50 50 50 50
45 45 45 45
40 40 40 40
35 35 35 35
30 30 30 30
25 25 25 25
20 20 20 20
15 15 15 15
10 10 10 10
5 5 5 5
0 0 0 0
0 10 20 30 40 50 0 10 20 30 40 50 0 10 20 30 40 50 0 10 20 30 40 50
(e)StationaryObs:VLL-MPC (f)StationaryObs:NMPC (g)StationaryObs:LMPC (h)StationaryObs:AnytimeRRT*
50 50 50 50
45 1 45 1 45 1 45
40 2 40 2 40 2 40
35 35 35 35
30 30 30 30
25 1 25 1 25 25
20 20 20 20
15 15 15 15
10 10 10 10
5 5 5 5
002 10 20 30 40 50 00 2 10 20 30 40 50 00 10 20 30 40 50 00 10 20 30 40 50
(i)MovingObs:VLL-MPC (j)MovingObs:NMPC (k)MovingObs:LMPC (l)MovingObs:AnytimeRRT*
Fig. 3: Robot traces in different scenarios
[Sub-optimality] Note that in Equation (10), we restrict pros and cons of each approach. Details on scenario setting
the behavior of W to a linear dynamic system with under- are described as follows:
approximate path set. Thus, the obtained control scheme [Free Space Scenario]: Free Space scenario is the simplest
is only optimal with respect to the linear model, but sub- case, where there is no constraint on robot position and no
optimal for the original nonlinear model. We believe it is a obstacle in the environment. The WMR can move freely on
fair cost of the efﬁciency improvement and maintaining the the plane. The initial state of the robot is [3,47,0] and the
stability. goal state is [36,25,1.5π]. We set the prediction horizon
H=30, c=1. With respect to anytime RRT*, we allow it to
VI. SIMULATION execute no longer than 10 seconds at each sampling instant.
[Stationary Obstacle Scenario]: Stationary Obstacle sce-
We compare our VLL-MPC method with state-of-the-
nario is more close to a real parking lot than Free Space
art navigation control algorithms, including NMPC [32],
scenario, with constraints on robot positions and stationary
LMPC[23]andanytimeRRT*[8].Asmentionedpreviously,
obstacles in the environment. The whole parking lot is a
NMPChastheoreticalguaranteeonthestabilityundercertain ×
[0,56] [0,50] rectangle area. There are 15 parking spaces
pre-conditions[26],LMPCcannotensurestabilityduetothe
in the parking lot, which arrange into three rows. Some of
introduction of additional disturbance (approximation error),
the parking spaces have already been occupied by WMRs.
while anytime RRT* no longer maintains the probabilistic
The concerned WMR needs to reach the goal parking space
stability. We empirically demonstrate it by simulation.
from the entrance without entering any other parking space
or going out of the parking lot area. The initial state and the
A. Experimental Setup
goal state are the same as in Free Space Scenario. We set
We consider a practical scenario, autonomous parking the prediction horizon H=30, c=1. Considering the all the
scenario, where the parameters of WMR are set as Vbound = possible situations, we conservatively set dsafe =6.25. The
2,∆T = 1. We carefully choose three typical scenarios, maximal execution time for anytime RRT* is 20 seconds.
which are named Free Space scenario, Stationary Obstacle [Moving Obstacle Scenario]: Moving Obstacle scenario is
scenario, and Moving Obstacle scenario, to demonstrate the further close to a real parking lot than Stationary Obsta-
155
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 10:52:55 UTC from IEEE Xplore.  Restrictions apply. TABLE I: Comparison on Efﬁency (Average Compu-
cle one. There are still position constraints and stationary
tation Time at Each Instant in Seconds)
obstacles. However, except for the WMR 1 we concern,
there is another WMR, WMR 2, in the environment. WMR Free StationaryObs MovingObs
1 needs to reach the goal parking space as in Stationary VLL-MPC 0.165 0.768 2.310
NMPC 1.463 36.64 131.5
Obstacle scenario, while WMR 2 wants to achieve that
LMPC 0.129 0.671 2.563
state [3,3,π], denoting the exit, from the current parking AnytimeRRT*1 10.00 20.00 60.00
space [28,39,1.5π]. One WMR should avoid to collide with 1Considering the characteristics of sampling based algo-
another during the process. In this case, a robot needs to rithms,wegiveacomputationtimeboundfortheanytime
act by guessing another robot’s behavior. As mentioned in RRT*ineachscenario.Suchasettingallowstheanytime
RRT*tosampleatleast800,1500,4200pointseachtime
Remark 3, we therefore integrate each MPC with a standard
on our platform in Free space, Stationary Obstacle and
distributed control method proposed in [33] to tackle it. We MovingObstaclescenariosrespectively.
set H=60, c=1, dsafe =6.25. The maximal execution time
for anytime RRT* in this scenario is 60 seconds.
All the simulations were performed on a computer In [8], only the situations with the pre-speciﬁed reference
equipped with 8 GB RAM and an Intel Core i5 4570 CPU trace were discussed in the experiments. A possible reason
under Windows. The LP and MILP problems were solved isthatateachinstant,thenumberofsamplingissmalldueto
bytheGurobisolver[34].NLPproblemsencounteredinthe the limited computation time and results at previous instants
NMPC were solved by Tomlab toolbox [35]. are dropped, which makes the sampling set not dense in the
state space and probabilistic stability no longer hold. Even
B. Result Analysis though RRT based approaches show the great advantage in
The traces computed by various algorithms are shown in off-line motion planning, it still needs more effort to ensure
Fig3.Inallthesub-ﬁgures,aWMRisdrawnasarectangle, the stability for on-line planning.
where the short purple edge denotes the back and the red Table I shows the efﬁciency, i.e. the average computation
point denotes the center. The blue and green *’s denote timeateachinstant,ofallthealgorithmsintermsofdifferent
the initial position and the goal positions respectively. The scenarios. In the following, we explain the table in detail.
white space denotes the permitted moving area for WMRs. • Compare with NMPC: VLL-MPC achieved at least
In the scenarios with obstacles (Fig 3e-3l), the parking lot is 88.7% improvement, and the computation time of
drawn as a large rectangle with red edges, the yellow areas NMPC grew rapidly with the complexity of scenarios.
denote the parking spaces and the blue rectangles denote The result ﬁtted well our theoretical conclusion in
the stationary WMRs. Observing Fig 3a, 3e, 3i, VLL-MPC Section V.
completed the navigation task in all the scenarios. • Compare with LMPC: Due to that the optimization
NMPCalsoﬁnishedthesimulation(seeFig3b,3f,3j).Itis problems involved in our VLL-MPC and LMPC are
worthynotingrobotsmovedslowlyatsomepointsinMoving both linear programming and of the same scale, it is
Obstaclescenario.Thereasonisthattheperformanceofnon- not surprised that they share the similar efﬁciency.
linear solvers relies heavily on the initial guess of decision • Compare with Anytime RRT*: Anytime RRT* has a
variableswhilesolvingNLPproblems.Incomplicatedcases, high chance to fail the experiment, even though it is
it is difﬁcult to ﬁnd an appropriate initial value. When the 1 order-of-magnitude longer than the time required by
default initial value cannot lead to a solution satisfying the VLL-MPC.Itisworthynotingthatwemayletitstable
sufﬁcient condition of stability, we will randomly pick an by specifying a sufﬁcient large time bound. However,
initial value in the neighborhood of the current state. such a setting makes anytime RRT* degenerate to the
LMPC did not ﬁnish any scenario (See Fig 3c, 3g, 3k). traditional off-line version.
As mentioned in Section III, linearization is precise only
locallyaroundthegivenequilibriumpoint.Sinceonecannot VII. CONCLUSION
“predict” the linearization of the system at future steps, the In this paper, we show reachable set based HMPC, one of
linearization error will will inevitably accumulate over time theadvancedMPCtechniquesforrobotcontrol,cannothan-
and make the robot dynamic uncontrollable. As a result, dleWMRnavigation.ThenweproposeVLL-MPCtoenable
the robot was going to leave the default observable area in HMPC structure to improve the efﬁciency compared with
Figure 3c, while in Figure 3g and 3k, the WMR just moved NMPC while maintaining stability. Future work includes the
chaotically around the initial position. integrating VLL-MPC with RRT for off-line path planning.
Notably there exists randomness in RRT-based methods,
therefore we ran Anytime RRT* 10 times for each scenario, ACKNOWLEDGEMENT
where Fig 3d, 3h, 3l show the best results. Anytime RRT* ThisresearchwassupportedbytheNationalKeyResearch
succeeded in the Free Space scenario but failed in other andDevelopmentProgramofChina(No.2017YFA0700604),
two. More speciﬁcally, the robot stuck for a long time from and the National Natural Science Foundation of China
a certain instant in the Stationary and Moving Obstacle (No.61690204, No.61772347, No.61836005, No.61572249,
scenarios. In fact, there is currently no explicit theoretical No.61772260). Dr. Yifeng Zeng is also supported by the
result on the stability of anytime version of RRT or RRT*. EPSRC Grant (EP/S011609/1).
156
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 10:52:55 UTC from IEEE Xplore.  Restrictions apply. REFERENCES [17] H.A.v.EssenandH.Nijmeijer,“Non-linearmodelpredictivecontrol
for constrained mobile robots,” in ECC, 2001, Conference Proceed-
[1] G. Wagner and H. Choset, “M*: A complete multirobot path plan-
ings,pp.1157–1162.
ning algorithm with performance bounds,” in IROS. IEEE, 2011,
[18] C. Huang, X. Chen, Y. Zhang, S. Qin, Y. Zeng, and X. Li, “Hierar-
ConferenceProceedings,pp.3260–3267.
chicalmodelpredictivecontrolformulti-robotnavigation,”inIJCAI.
[2] W. Zeng and R. L. Church, “Finding shortest paths on real road
AAAIPress,2016,ConferenceProceedings,pp.3140–3146.
networks: the case for a*,” International journal of geographical
[19] B. Picasso, X. Zhang, and R. Scattolini, “Hierarchical model
informationscience,vol.23,no.4,pp.531–543,2009.
predictive control of independent systems with joint constraints,”
[3] S.M.LaValle,“Rapidly-exploringrandomtrees:Anewtoolforpath
Automatica, vol. 74, pp. 99–106, 2016. [Online]. Available:
planning,”1998.
http://www.sciencedirect.com/science/article/pii/S0005109816302989
[4] S.KaramanandE.Frazzoli,“Sampling-basedalgorithmsforoptimal
[20] C.Huang,X.Chen,Y.Zhang,S.Qin,Y.Zeng,andX.Li,“Switched
motionplanning,”Int.J.Rob.Res.,vol.30,no.7,pp.846–894,2011.
linear multi-robot navigation using hierarchical model predictive
[5] Z. Li, J. Deng, R. Lu, Y. Xu, J. Bai, and C. Y. Su, “Trajectory-
control,” in IJCAI, 2017, Conference Proceedings, pp. 4331–4337.
trackingcontrolofmobilerobotsystemsincorporatingneural-dynamic
[Online].Available:10.24963/ijcai.2017/605
optimized model predictive approach,” IEEE Transactions on SMC:
Systems,vol.46,no.6,pp.740–749,2016. [21] E.Asarin,O.Bournez,T.Dang,andO.Maler,“Approximatereach-
[6] C. J. Ostafew, A. P. Schoellig, T. D. Barfoot, and J. Collier, ability analysis of piecewise-linear dynamical systems,” in HSCC.
“Learning-based nonlinear model predictive control to improve Springer,2000,ConferenceProceedings,pp.20–31.
vision-based mobile robot path tracking,” Journal of Field Robotics, [23] F.Ku¨nhe,J.Gomes,andW.Fetter,“Mobilerobottrajectorytracking
vol. 33, no. 1, pp. 133–152, 2016. [Online]. Available: http: usingmodelpredictivecontrol,”inLARS,2005,ConferenceProceed-
//dx.doi.org/10.1002/rob.21587 ings.
[7] S. M. LaValle, Planning algorithms. Cambridge university press, [24] S.Mitra,“Averiﬁcationframeworkforhybridsystems,”Thesis,2007.
2006. [25] R. Alur, R. Grosu, I. Lee, and O. Sokolsky, “Compositional reﬁne-
[8] S. Karaman, M. R. Walter, A. Perez, E. Frazzoli, and S. Teller, ment for hierarchical hybrid systems,” in HSCC. Springer, 2001,
“Anytime motion planning using the rrt,” in ICRA. IEEE, 2011, ConferenceProceedings,pp.33–48.
ConferenceProceedings,pp.1478–1483. [26] D. Q. Mayne, J. B. Rawlings, C. V. Rao, and P. O. M. Scokaert,
[9] J.D.Herna´ndez,E.Vidal,G.Vallicrosa,E.Galceran,andM.Carreras, “Constrained model predictive control: Stability and optimality,” Au-
“Online path planning for autonomous underwater vehicles in un- tomatica,vol.36,no.6,pp.789–814,2000.
knownenvironments,”inICRA. IEEE,2015,ConferenceProceedings, [27] C.Huang,X.Chen,W.Lin,Z.Yang,andX.Li,“Probabilisticsafety
pp.1152–1157. veriﬁcation of stochastic hybrid systems using barrier certiﬁcates,”
[10] T.KunzandM.Stilman,“Kinodynamicrrtswithﬁxedtimestepand ACMTransactionsonEmbeddedComputingSystems(TECS),vol.16,
best-inputextensionarenotprobabilisticallycomplete,”inAlgorithmic no.5s,pp.1–19,2017.
foundationsofroboticsXI. Springer,2015,pp.233–244. [28] Z. Yang, C. Huang, X. Chen, W. Lin, and Z. Liu, “A linear pro-
[11] M.Ramirez,M.Papasimeon,L.Benke,N.Lipovetzky,T.Miller,and grammingrelaxationbasedapproachforgeneratingbarriercertiﬁcates
A.R.Pearce,“Real–timeuavmaneuveringviaautomatedplanningin ofhybridsystems,”inInternationalSymposiumonFormalMethods.
simulations,”inIJCAI. AAAIPress,2017,ConferenceProceedings, Springer,2016,pp.721–738.
pp.5243–5245. [29] A. Bemporad and M. Morari, “Control of systems integrating logic,
[12] E. Ferna´ndez-Gonza´lez, E. Karpas, and B. C. Williams, “Mixed dynamics,andconstraints,”Automatica,vol.35,no.3,pp.407–427,
discrete-continuousheuristicgenerativeplanningbasedonﬂowtubes,” 1999.
inIJCAI,2015,ConferenceProceedings,pp.1565–1572.
[30] Y. Kuwata and J. P. How, “Stable trajectory design for highly con-
[13] G.Williams,N.Wagener,B.Goldfain,P.Drews,J.M.Rehg,B.Boots,
strainedenvironmentsusingrecedinghorizoncontrol,”inACC,vol.1.
and E. A. Theodorou, “Information theoretic mpc for model-based
IEEE,2004,ConferenceProceedings,pp.902–907.
reinforcement learning,” in 2017 IEEE International Conference on
[31] R. Hemmecke, M. Ko¨ppe, J. Lee, and R. Weismantel, “Nonlinear
RoboticsandAutomation(ICRA). IEEE,2017,pp.1714–1721.
integerprogramming,”in50YearsofIntegerProgramming1958-2008.
[14] F.R.Hogan,E.R.Grau,andA.Rodriguez,“Reactiveplanarmanipula-
Springer,2010,pp.561–618.
tionwithconvexhybridmpc,”in2018IEEEInternationalConference
[32] A. Boccia, L. Gru¨ne, and K. Worthmann, “Stability and
onRoboticsandAutomation(ICRA). IEEE,2018,pp.247–253.
feasibility of state constrained mpc without stabilizing terminal
[15] A.Tanguy,D.DeSimone,A.I.Comport,G.Oriolo,andA.Kheddar,
constraints,” Systems & Control Letters, vol. 72, pp. 14–21, 2014.
“Closed-loop mpc with dense visual slam-stability through reactive
[Online]. Available: http://www.sciencedirect.com/science/article/pii/
stepping,”in2019InternationalConferenceonRoboticsandAutoma-
S0167691114001595
tion(ICRA). IEEE,2019,pp.1397–1403.
[33] T. Keviczky, F. Borrelli, and G. J. Balas, “A study on decentralized
[16] I. B. Hagen, D. K. M. Kufoalor, E. F. Brekke, and T. A. Johansen,
receding horizon control for decoupled systems,” in ACC, vol. 6.
“Mpc-based collision avoidance strategy for existing marine ves-
IEEE,2004,ConferenceProceedings,pp.4921–4926.
sel guidance systems,” in 2018 IEEE International Conference on
RoboticsandAutomation(ICRA). IEEE,2018,pp.7618–7623. [34] I. Gurobi Optimization, “Gurobi optimizer reference manual,” 2016.
[22] E.Goubault,O.Mullier,S.Putot,andM.Kieffer,“Innerapproximated [Online].Available:http://www.gurobi.com
reachabilityanalysis,”inhscc. ACM,2014,ConferenceProceedings, [35] K. Holmstro¨m and M. M. Edvall, The tomlab optimization environ-
pp.163–172. ment. Springer,2004,pp.369–376.
157
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 10:52:55 UTC from IEEE Xplore.  Restrictions apply. 