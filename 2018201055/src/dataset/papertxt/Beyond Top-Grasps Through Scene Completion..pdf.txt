2020 IEEE International Conference on Robotics and Automation (ICRA)
31 May - 31 August, 2020. Paris, France
Fast, Versatile, and Open-loop Stable Running Behaviors with
Proprioceptive-only Sensing using Model-based Optimization
∗
Wei Gao, Charles Young, John Nicholson, Christian Hubicki and Jonathan Clark
Abstract—Aswebuildourleggedrobotssmallerandcheaper, (a) (b) Fast model-based 
stable and agile control without expensive inertial sensors optimization
becomesincreasinglyimportant.Weseektoenableversatiledy-
namicbehaviorsonrobotswithlimitedmodesofstatefeedback,
speciﬁcally proprioceptive-only sensing. This work uses model-
based trajectory optimization methods to design open-loop
stable motion primitives. We speciﬁcally design running gaits
forasingle-leggedplanarrobot,andcangeneratemotionprim-
itivesinunder3seconds,approachingonline-capablespeeds.A
direct-collocation-formulatedoptimizationgeneratedaxialforce
proﬁles for the direct-drive robot to achieve desired running (c)
speed and apex height. When implemented in hardware, these
trajectories produced open-loop stable running. Further, the
measured running achieved the desired speed within 10% of
the speed speciﬁed for the optimization in spite of having no
control loop actively measuring or controlling running speed.
Additionally, we examine the shape of the optimized force
proﬁleandobservefeaturesthatmaybeapplicabletoopen-loop
stable running in general. Fig. 1. Overview. (a) A single-legged hopper with reduced-order model
superimposed.(b)Fastmodel-basedoptimizationgeneratescontrollerforce
proﬁle in 3s. (c) Open-loop stable running achieves average forward
I. INTRODUCTION velocityof3.8m/s.
The fact that legged animals in the natural world can
traverse diverse terrains with great agility has inspired re-
computationally limited robots such as DASH, HAMR, and
searchers to develop a variety of legged robots. To emulate
others [8], [9], [10].
dynamic and adaptive legged locomotion observed on ani-
No matter it is stiffness modulation or rest length mod-
mals,theserobotsneednotonlyrobustlegcontrollersforone
ulation or the two combined, eventually the controller is
environment,butalsoadvancedtechniquesthatcanoptimize
modulating the leg force based on time during the stance
the controllers for various environment on-the-ﬂy.
phase. As long as an optimized time-based force proﬁle can
Leg controllers are often bio-inspired, to duplicate the
begenerated,itisonlyamatteroftranslatingtheforceproﬁle
major functionality of biological systems through straight-
into stiffness proﬁle and/or rest length proﬁle. Although
forward mechatronic design and clever control laws. They
leg force optimization in simulation has been performed
are then simulated upon system models and veriﬁed through
before [11], it was for speciﬁc applications and the results
experiments. As a reduced-order model, the Spring-Loaded
werenotasgeneralasshowninthispaper.Moreimportantly,
Inverted Pendulum (SLIP) model has been shown to capture
the optimization techniques presented were not for real-time
the whole-body dynamics of a wide range of animals’
implementation, such that adaptive legged locomotion could
locomotion[1],[2]andwaskeytotheﬁrstdynamicrunning
notbeachieved.Experimentaloptimizationswerepreviously
robots pioneered by Raibert et al. [3]. These robots used
implemented on running platforms, which have successfully
an impulse-based scheme (instantaneous increase in spring
developed high-speed gaits (2.7m/s for RHex [12], and
stiffness at maximum compression) to move quickly, while
3.0m/s for Minitaur [13]), but these experiments have been
other early running robots such as RHex and iSprawl relied
very costly, taking tens of hours each.
upontime-based,open-loopschemesandthepassivedynam-
Roboticsingeneralhasmadeuseofincreasinglypowerful
ics of their legs [4], [5]. Subsequent studies have suggested
online optimization techniques to achieve versatile loco-
other time-based control policies including prescribing a
motion. The DARPA robotics challenge was a showcase
sinusoidal proﬁle for the rest length of leg spring during
of real-time planners for robots with full actuation [14].
the stance phase (AER) [6], or mixing rest length extension
More recently, model-predictive control (MPC) methods
with a softening spring stiffness [7]. Variants of these open-
have been used for highly dynamic quadruped maneuvers,
loop approaches to control continue to be used for small,
providing over 100Hz computation for systems with linear
dynamics [15]. Differential Dynamic Programming (DDP)
∗
Department of Mechanical Engineering, FAMU-FSU College of En-
also provides fast methods for trajectory generation in the
gineering, Florida State University, Tallahassee, Florida 32310, USA
clarkj@eng.famu.fsu.edu presence of underactuation [16]. For nonlinear robot models
978-1-7281-7395-5/20/$31.00 ©2020 IEEE 483
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 15:46:12 UTC from IEEE Xplore.  Restrictions apply. withhardcontrolconstraints(likedynamicgaitoptimization and allows it to do spherical movement around the base
in this paper), researchers have used model-based nonlinear freely, as shown in Figure 1(c). With large radius and small
programming (NLP) solvers like IPOPT [17] to achieve 1- polar angle, the leg is assumed to be moving in the sagittal
second optimization for walking maneuvers [18]. Fast and plane along the wooden track. Two Accu-Coder model 15s
stable running gaits have also been realized on bipedal encoders are located at the base of the boom, which operate
running robots using these techniques based on hybrid zero in the quadrature phase and measure the azimuth and polar
dynamics(HZD)[19],[20].ThisworkappliesNLPmethods angles of the tube. All the data are recorded via a Teensy
to achieve fast running optimization using the simple SLIP- 3.6 microcontroller at 500Hz, while the control frequency
based model. for the leg is set at 1000Hz. The major physical parameters
The paper takes time-based spring modulation as a po- of the robot are shown in Table I. Note that the nominal
tentially robust leg controller, and utilizes advanced op- leg rest length l is determined when the proximal links
o
timization techniques that can generate force proﬁles for are placed in horizontal conﬁguration, and the nominal leg
desired gaits within seconds. The physical platform, see stiffnessk issettothevaluescaledfromhumandata(mass
o
Figure 1, actuated by these optimal force proﬁles is shown = 80kg,nominal legrestlength =1m,nominal legstiffness
to achieve the expected gaits successfully. The remainder = 19600N/m) [7].
of the paper ﬁrst demonstrates the physical platform that is
used to realize spring modulation in Section II. Based upon TABLEI
the physical platform, dynamic models of the system are MAJORSYSTEMPARAMETERVALUES.
developed in Section III. Time-based force modulation as
Name Symbol Value
the controller is then optimized in Section IV. Section V
sees the experimental results as veriﬁcation of the obtained GravitationalAcceleration g 9.8m/s2
optimal force proﬁles. Conclusions are drawn in Section VI. MassattheHip m 1.2kg
NominalLegRestLength lo 0.1732m
II. PHYSICALPLATFORM NominalLegStiffness ko 1697N/m
SLIP-like runners have shown great success in robust LegLinearDamping bl 12.6371Ns/m
legged locomotion. The SLIP-like runner used for spring HipTorsionalDamping bt 0.0812Nms/rad
modulation in this paper is a single-legged hopper as shown ProximalLinkLength l1 0.1m
inFigure1(a).ThelegcomesfromtheMinitaurquadrupedal DistalLinkLength l2 0.2m
platform [21]. It has a ﬁve-bar mechanism driven by two
co-axial Tiger U8 brushless DC motors at the hip, thus a
III. SIMULATIONMODEL
virtual spring can be imagined to connect the hip and the
A. The Force-Driven and Damped SLIP Model
foot,aswellasadamperandanactuatorinparallel.Through
modulatingthecontroleffortofhipmotors,forcemodulation Tomatchthephysicalplatform,aforce-drivenanddamped
by the actuator to the virtual leg spring can be achieved. SLIP (FD-SLIP) model is developed, as shown in Figure 2.
Among the ﬁve links in the leg, one is the u-shape Compared to the SLIP model, the FD-SLIP model has a
bracket that connects stators of the two motors, two are the linear damper and an actuator in parallel to the leg spring,
proximal links of length 0.1m that are attached to rotors and an additional torsional damper around the hip.
of the two motors, and two are the distal links of length
0.2m that are connected to the proximal ones at the knees 𝑔𝑔 Forward Direction 𝑥𝑥̇
𝑎𝑎𝑎𝑎𝑎𝑎𝑎𝑎
and also interconnected at the ankle. The revolute joints
𝑚𝑚
at the two knees and the ankle are all passive. Leg links 𝑏𝑏
𝑘𝑘 ,𝑙𝑙
were previously fabricated from aluminum using waterjet 𝑜𝑜 𝑜𝑜 𝑡𝑡
machining.Currently,onlytheproximallinksaremadefrom 𝑧𝑧
aluminum, while the distal links and foot were revised to 𝑧𝑧 𝑥𝑥 𝜓𝜓 𝜁𝜁 𝑏𝑏𝑙𝑙 𝑎𝑎𝑎𝑎𝑎𝑎𝑎𝑎 𝜁𝜁𝑇𝑇𝑇𝑇 𝜓𝜓
be 3D printed for a 48% reduction of the distal mass. 𝑇𝑇𝑇𝑇
This improvement was achieved using a Markforged Mark
Two printer with Onyx ﬁlament and continuous carbon ﬁber
reinforcement. The foot extension at the ankle is made of
a 3D printed structure with a tread layer to produce high Stance Flight
friction and avoid slippage. The foot’s printed substrate is
comprised entirely of Markforged Onyx material, and the Fig.2. AsketchoftheFD-SLIPmodel.
elastomeric tread is overmolded using Smooth-On VytaFlex
60 urethane. A single step of the FD-SLIP model consists of a stance
Hall Effect based absolute encoders located on the hip phase and a ﬂight phase. The transition event from stance
motorsprovidethemotorpositionsasfeedbacksignalstofa- phase to ﬂight phase is deﬁned as liftoff, and from ﬂight
cilitateclosed-loopcontrolofthelegposition.Analuminum phase to stance phase is deﬁned as touchdown. During the
tube of length 1.15m holds the leg at the u-shape bracket stancephase,becausethefootispinneddowntotheground,
484
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 15:46:12 UTC from IEEE Xplore.  Restrictions apply. thesystemcanbeconvenientlydescribedinpolarcoordinates From Equation (3), th(cid:18)e J(cid:19)acobian(cid:18)ma(cid:19)trix J relating the mo-
(ζ,ψ),withζ beingleglengthfromthefoottothehipandψ tors’ angular velocities to the virtual leg’s linear and angular
being leg angle measured clockwise from the ground to the velocities in
leg(the smaller angle of the two). The equations of motion ζ˙ ψ˙
=J 1 (4)
forthe stance phase can be derived as ψ˙ ψ˙2 
(cid:20) (cid:21)
ζ¨=ζψ˙2−gsinψ− ko(ζ−l )− blζ˙+ u, can be derived as  
m o m m (1)  ∂ζ ∂ζ 
−2ζ˙ψ˙ − gcosψ − b
ψ¨= ζ ζ mζt2ψ˙, J = JJ11 JJ12 = ∂∂ψψ1 ∂∂ψψ2 , (5)
21 22
where u is the force input from the actuator. The effect of  ∂ψ ∂ψ
1 2
dptAhiasfepfeelaerr,egrnsetotsouﬂailittmgs,hidtntheiepsmihrsaaeylsdseftuteocnmuoccntihitosrdonoolalwlnelrcnysoanianstfrgfobleeleclyetψeordTnisdDbaytdahfoegtperstraecvldoiif,pttyreoefsodfefu[tr2ttiih2nni]ggs. whJer1e1 =J12 = (cid:114)ψ +ψ ψ +ψ
l2sin 1 2 cos 1 2
tihThnohereiCzﬂeaoiqgrntuhteaatsltiipaoahnnnasdsceoovfowermrdhtiieoncrtaaeiolten(cid:40)iptssoc(samxintoi,obtzine)os,neaowissfiitlcthyhoednxvebreoianvndieedydn,tazlrysesbdpeeeiscnctgirvibetlehyde. J −=−l211si,nψ1+2 ψ2 − 12 l22−2l12sin2 ψ1+22ψ2 ,
21 2
x¨=0,
− (2) 1
z¨= g. J22 = 2.
(6)
Notethattheequationsofmotionforthestancephasecannot
The Jacobian matrix(cid:18)J c(cid:19)an also b(cid:18)e us(cid:19)ed to relate leg forces
be analytically solved, while those for the ﬂight phase can,
to motor torques as in
which simpliﬁes the optimization setup that is discussed in
Section IV. F − τ
ζ =J T 1 , (7)
τ τ
B. The Spring Modulation Controller ψ 2
ThetermuinEquation(1)issupposedtofollowtheforce where Fζ is the force along the leg, τψ is the torque around
proﬁle applied by the controller. However, the spring modu- the hip, and τ and τ are the corresponding torques applied
1 2
lation controller on the physical platform is implemented in by the two hip motors. To relate back to Equation (1), the
the motor space instead of the virtual leg space. Therefore, force F in Equation (7) can be written as
ζ
a mapping between the two spaces is necessary. A sketch − −
F = k (ζ l )+u, (8)
visually showing the relationship between the two spaces ζ o o
can be found in Figure 3. The angular positions of two hip whilethetorqueτ isalwayssettozerotoallowfreerotation
ψ
motorsarerepresentedbyψ andψ ,respectively,measured during the stance phase. Consequently, by commanding
1 2
from the negative z direction to the corresponding links. motor torques τ1 and τ2 in Equation (7), the desired leg
force F , or the desired force input u, can be achieved.
ζ
𝑙 The force modulation proﬁle for u, as mentioned in Sec-
1
tionI,canbefurtherinterpretedaseitherstiffnessmodulation
𝜓 𝜓
1 2 or rest length modulation based on Equation (8):
− − u −
𝑙2 F = (k − )(ζ l ) (9)
ζ o ζ l o
o
or
− − u
𝜁 F = k [ζ (l + )]. (10)
𝜓 ζ o o k
o
Note that when the force modulation is interpreted as stiff-
ness modulation, the effective stiffness is based on not
only time, but also state ζ, which makes the case more
complicatedthanbeinginterpretedasrestlengthmodulation.
Fig.3. Asketchillustratingthemappingbetweenthephysicalleg(solid
lines)andthevirtualleg(dashlines).
IV. CONTROLOPTIMIZATION
Due to symmetry of the l(cid:114)eg, the length ζ and angle ψ of Obtaining the optimal time-based force proﬁles for the
thevirtual leg can be written as stancephaseinvolvessolvingatrajectoryoptimizationprob-
lem.Toachievestablerunninggaits,theoptimizationprocess
ζ =l cosψ1+ψ2 + l2−l2sin2 ψ1+ψ2, should at least fulﬁll two tasks: identify periodic gaits,
1 −2 2 1 2 (3)
or limit cycles, and evaluate the stability of those limit
π − ψ ψ
ψ = 1 2. cycles. Conventional approach for searching limit cycles
2 2
485
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 15:46:12 UTC from IEEE Xplore.  Restrictions apply. would assign one set of possible controller parameter values such as stance time [11]. Explicitly, the trajectory constraint
each time, integrate the system dynamics via time-marching G can be written as
numerical methods, and adjust the system initial states ac- [−k (ζ−l )−b ζ˙+u]sinψ−b ψ˙cosψ/ζ ≥0,
cordingtogradientbasedmethodsuntiltherequirementsfor o o l t
| |
limit cycles are met. This approach is generally called the | |≤ − ψ˙
τ τ (1 1,2 ),
directsingleshootingmethod.Itcanproviderichinformation 1,2 stall ω
NL (12)
about the controller parameter space when the dimension of
where the ﬁrst expression requires the ground reaction force
that space is relatively small (less than ﬁve), thus insights
to be non-negative during the stance phase and the second
can be extracted. However, it becomes intractable quickly
expression reveals a linear torque-speed curve in the motor
when the dimension grows bigger, which is exactly the case
in this paper. To describe an arbitrary and smooth time- model.Theexpressionsforψ˙1,2 andτ1,2 canbederivedfrom
based force proﬁle, given the typical stance time for the Equations (4) and (7), and the subscript 1,2 just means the
two motors share the same model. The stall torque and no-
single-legged hopper is on the order of tens of milliseconds
and the controller updates every millisecond, the required load speed are rated to be: τstall = 7.69Nm and ωNL =
number of way points on the proﬁle can easily go above 158rad/s.Ontheotherhand,theboundaryconstraintH can
tnoteoepnet,isdmowlitvhzoeiactbhitoehnmeoetpepatcrinmohsbnimlzieqeomudre.e,[Tt2chha3ael]lnr,eedtfueosndrieinrc,geocantatlbrcgoeoeltllbtleeorrracipasctauiroicatneom,dnesitstterraarajidvenoactpsltuoteertydos beζζ˙d((tteTTmDDo))ns==traltoe,d separ(cid:112)ately as touchdown conditions
− − −
smreosaluvrcelth,sintyhgsetemompettdihmyonidza.amWtiiocensucisnaesnteIbPaedOaPocTfcotahmseptlahifseohreNedmLwPenittshiooilnnveesdre.ctAoimnsdeas- ψψ˙((x˙ttaTTpDDex))c==osψψTTDD, (cid:112) 2g(zapex losinψTD)sinψTD,
rather than several hours or even days for conventional − −
controller parameter sweeps. Although detailed information [x˙apexsinψTD 2g(zapex losinψTD)cosψTD]/lo,
about the controller parameter space is lost in this manner, u(tTD)=0,
the fast optimization speed makes it promising for real-time  (13)
atbopepBtlhceiheccaaanrtuiaooscmenteitornhinazelealdleepggbhylyreesnitsgchtatrhleleepnalgtvattathofr,ouiarlcmboh,ld.eaos:wgtnaoi,tuζcoThfDdtoh,weisnsayllsewtgeamyasncgsaelnet anζ[dζ((tltiLfLtOoO)f)ψfψ˙˙c((totLnLOdOi)t)isocinonssψψ(t(LtLOO))−+ζ˙ζ(˙t(LtLOO))csoisnψψ((ttLLOO))]=2/x(˙2apge)x,
ψGcaTinvDebn,eaapanenxaalhypeteiixcgahhltleyzigashpoetlxva,endadnfdohraoprtehizxeohnﬂotiagrlihztvoenplthoaaclsivteye,laoctcchioetyrdsxiy˙nasgpteemtxo. ζζ˙˙((ttLLOO))s≥in0ψ,(tLO)+ζ(tLO+)ψζ˙((ttLLOO))csionsψψ((ttLLOO))=≥z0a,pex,
Equation (2), yielding boundary conditions for the stance {− − − }
phase. Therefore, the optimization only needs to deal with ko[ζ(tLO) lo] blζ˙(tLO)+u(tLO) sinψ(tLO)
−
the stance phase. The optimization problem can then be b ψ˙(tLO)cosψ(tLO)/ζ(tLO)=0.
t
mathematically stated as (14)
(cid:88)
The optimization was implemented in MATLAB 2018b
usingtheCOALESCEtoolbox[24]andexecutedforarange
tLO
argmin [u(t)]2, of [x˙apex,zapex,ψTD] to seek the corresponding optimal
force proﬁle u. By satisfying all the constraints, the yielded
t=tTD
gaits are automatically limit cycles. The stability of each
s.t. s˙(t)=F[t,s(t),u(t)],
limit cycle is then evaluated by the maximum Floquet mul-
≥
G[t,s(t),u(t)] 0, tiplier[25].Therangessweptfor[x˙apex,zapex,ψTD]are,in
≥
H[tTD,s(tTD),u(tTD),tLO,s(tLO),u(tLO)] 0, turn, from 1.5m/s to 4m/s with an increment of 0.5m/s,
(11) from0.18mto0.27mwithanincrementof0.01m,andfrom
◦ ◦ ◦
where t is time, s is the system state vector (s = 60 to 89 with an increment of 1 . A stability distribution
[ζ,ζ˙,ψ,ψ˙]T), superscript TD stands for the moment of map is thus obtained as shown in Figure 4. The horizontal
touchdown, superscript LO stands for the moment of liftoff, axis represents the apex horizontal velocity and the vertical
F represents the dynamic constraint that is the state space axis represents the apex height. While multiple gaits can be
form of Equation (1), G represents the trajectory constraint foundateachcombinationofapexheightandvelocitydueto
that includes ground reaction force and motor model, and different touchdown angles, the color indicates performance
H represents boundary constraint that contains touchdown of the most stable gait. Note that the distribution map
and liftoff conditions. Note that the cost function adopted only shows the stability of the optimal gait obtained from
in Equation (11) is the sum of squared force input required trajectoryoptimization.Forexample,itindicatesthatthegait
to achieve the limit cycle, which is related to efﬁciency of with apex horizontal velocity of 4m/s and apex height of
the gait. Other reasonable cost functions could also be used, 0.18m can be optimized to be the most stable. However, it
486
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 15:46:12 UTC from IEEE Xplore.  Restrictions apply. does not imply that the gait tends to be more stable with the reasons behind, a typical gait marked by the star in
lower apex height and faster apex horizontal velocity. This Figure 4 is selected and the corresponding optimal force
is the shortcoming of this two-layer style optimization. In proﬁle, vertical ground reaction force proﬁle and Center of
the future, it is desired to merge the stability evaluation into Mass(CoM)trajectoryareplottedinFigure5.Itappearsthat
the optimization process. This may require clever design of there are generally three stages for the optimal force proﬁle.
the cost function and is beyond the scope of this paper. Theﬁrststageinvolvesaportionofnegativeforceinputonce
the leg starts breaking at the beginning of the stance phase.
The vertical ground reaction force at this stage is mitigated
𝜆=1
tozero.Thesecondstageisatransitionfromtheﬁrststageto
thethirdwhereanabruptchangeintheforceproﬁlehappens,
from negative to positive values. This happens when the leg
vaults over the upright direction, switching from breaking
modetothrustingmode.Onceentersthethirdstage,theforce
input starts ramping up to accelerate the system, ﬁrst slowly
and then quickly, until liftoff happens. This optimal force
proﬁlesharestheﬂavorsoftheﬁxedthrust(FT)controller[6]
where there is an abrupt force increase around maximum
leg compression and the AER controller where the force
proﬁle follows a sinusoidal trajectory when ramping up. It
can potentially inspire new leg controllers in future work
whereonlineoptimizationisnotfeasible,suchasgramscale
microrobots [26], [27].
Fig.4. Stabilitydistributionofthegaitsdrivenbyoptimalforceproﬁles. V. EXPERIMENTALVERIFICATION
TheeigenvalueλisdeﬁnedasthemaximumFloquetmultiplier.
To implement the optimal force proﬁle on the physical
platform, several issues were addressed. First, the optimal
forceproﬁleisgeneratedseparatelyfromthemaincontroller
board’s Arduino 1.6.1 code and must be uploaded prior to
each experimental run. The force proﬁle data array is trans-
mitted via USB-TTL serial communication from MATLAB
2018b to the main controller board where it is stored. The
controllercodelatercallsthestoredarraytoapplythecorrect
force input when stance phase is triggered. Second, real-
time datalogging is needed to simultaneously collect data
from the physical platform and main controller board that
is communicated via serial communication. A Teensy 3.6
microcontroller stores the data to a micro SD card to allow
forpost-processing.Thisdatasetincludes:theplatform’stwo
angular encoders located at its base and boom arm, current
sensing of the motor controllers’ inputs, and the virtual-
leg calculations that result from the main controller board’s
access to motor encoders located at the hip axis.
Additionally, the physical platform has a software-based,
touchdown delay mechanism to reduce erroneous stance
phasetriggeringandenablerobustrunningperformance.The
touchdown delay mechanism consists of two stages, the ﬁrst
requires a positive leg compression such that the estimated
leg force passes a threshold to initiate the touchdown signal,
and the second requires the touchdown signal to last for
seven consecutive milliseconds to trigger the stance phase.
Fig. 5. Details of the red star gait in Figure 4, with the top left plot Thesameprocedureisusedtotriggerﬂightphase,butithas
beingtheoptimalforceproﬁle,thetoprightplotbeingtheverticalground
a less signiﬁcant impact on the force proﬁle optimization.
reactionforce(GRF)proﬁle,andthebottomplotbeingtheCenterofMass
trajectoryfromoneapexpointtothenext. The empirical force threshold used for touchdown is 10N.
Accordingly, the optimization setup presented in Section IV
Based upon the stability distribution map, the generated is modiﬁed to take into account the effect of touchdown
optimal force proﬁles can better stabilize the gaits with high delay. Speciﬁcally, the calculation of touchdown conditions
apex horizontal velocities and low apex heights. To explore in Equation (13) involves numerically solving the system
487
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 15:46:12 UTC from IEEE Xplore.  Restrictions apply. dynamicspresentedinEquation(1)forthetouchdowndelay height. On the other hand, the apex horizontal velocities
period. Note that during this period, the actuator is not of the three 2.5m/s gaits have greater errors than the
working yet, thus u=0N. This numerical process currently other gaits, possibly because of their poorer stability (larger
uses ode45 function in MATLAB which slows down the eigenvalues as shown in Figure 4). The other six gaits’
±
entire optimization process by nearly 50%, from around 2s apex horizontal velocities are within 10% of their desired
to around 3s, and can be improved in the future by using an values.
approximated analytical solution.
Experimental veriﬁcation examined gaits with 4 apex
horizontalvelocities(2.5m/s,3.0m/s,3.5m/sand4.0m/s)
and 3 apex heights (0.18m, 0.20m and 0.22m), 12 combi-
nations in total. With reasonable touchdown angles limited
◦
by ground friction (slipping occurs below 70 ), the new
optimization setup with touchdown delay mechanism was
able to ﬁnd optimal force proﬁles for 9 out of the 12
combinations.Theoptimalforceproﬁleforthegaitfeaturing
◦
x˙apex = 4.0m/s, zapex = 0.18m and ψTD = 77 can be
foundinFigure6(a).Thisforceproﬁle,comparedtotheone
shown in Figure 5, does not have the ﬁrst stage negative
forceinputtoreducetheverticalgroundreactionforce.This
isduetothefactthatthetouchdowndelaymechanismcloses
the time window for that portion. The new force proﬁles
starts directly from the second transition stage. The apex
states of this gait in experiments are plotted for each step in
Figures 6(b). It can be seen that the system performance at
steady state is very close to the expected values, with errors
±
within 10%. This gait enabled the single-legged hopper to
achievethemaximumforwardspeedthusfar,approximately
3.8m/s. Fig.7. Achievedsteady-stateapexstatesforallthe9testedgaits.
Overall, the successful implementation on the physical
platform and the fast execution speed indicate that it is
promising for real-time application. In the future, with im-
provementondatatransmissionandgaittransition,real-time
gait switching can be expected on the physical platform.
VI. CONCLUSIONS
This paper uniﬁes time-based stiffness and rest length
(a) (b) modulation as a spring modulation controller for SLIP-like
runners. It takes advantage of direct collocation method to
Fig.6. Informationaboutthegaitfeaturingx˙apex =4.0m/s,zapex =
◦ handle system dynamics and can generate optimal force
0.18mandψTD =77 .(a)Optimalforceproﬁle.Asacomparison,the
optimalforceproﬁleforgaitfeaturingx˙apex=2.5m/s,zapex=0.18m input for desired gaits within seconds, which is critical
◦
and ψTD = 78 is also plotted. The optimization took into account the to adaptive legged locomotion. Besides, the shape of the
touchdowndelaymechanism.(b)Achievedapexstatespereachstepfrom
obtained optimal force proﬁles can potentially inspire new
experiments.
legcontrollersonplatformswhereonlineoptimizationisnot
The performance of the other 8 gaits can be found in feasible.Themodel-basedoptimizationresultsareveriﬁedon
Figure 7, where the colored circles indicate the desired gaits hardware,enablingthesingle-leggedhoppertorunasfastas
and the colored error bars indicate the actual performance 3.8m/s.
of the gaits. The length of the error bars are dictated by
the actual ﬂuctuation of experimental performance, with ACKNOWLEDGMENT
boundary values being the minimum or maximum steady-
state experimental values. For all the 9 tested gaits shown The authors gratefully acknowledge the support by the
in Figure 7, the actual apex heights are consistently higher collaborative participation in the Robotics Consortium spon-
than the desired apex heights. This may be due to the drift sored by the U.S. Army Research Laboratory under the
of reference point. More signiﬁcantly, the change of desired Collaborative Technology Alliance Program, Cooperative
apex height positively relates to the change of actual apex Agreement DAAD 19-01-20012.
488
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 15:46:12 UTC from IEEE Xplore.  Restrictions apply. REFERENCES [23] O. Von Stryk, “Numerical solution of optimal control problems by
direct collocation,” in Optimal Control. Springer, 1993, pp. 129–
143.
[1] R. J. Full and D. E. Koditschek, “Templates and anchors: neu-
romechanical hypotheses of legged locomotion on land,” Journal of [24] M. S. Jones, “Optimal control of an underactuated bipedal robot,”
experimentalbiology,vol.202,no.23,pp.3325–3332,1999. 2014.
[25] A. Goswami, B. Espiau, and A. Keramane, “Limit cycles and their
[2] R. M. Alexander, Principles of animal locomotion. Princeton
stabilityinapassivebipedalgait,”inRoboticsandAutomation,1996.
UniversityPress,2003.
Proceedings.,1996IEEEInternationalConferenceon,vol.1. IEEE,
[3] M.H.Raibert,Leggedrobotsthatbalance. MITpress,1986.
1996,pp.246–251.
[4] R. Cham and M. S. Redfern, “Changes in gait when anticipating
[26] R. S. Pierre and S. Bergbreiter, “Gait exploration of sub-2 g robots
slipperyﬂoors,”Gait&posture,vol.15,no.2,pp.159–171,2002.
using magnetic actuation,” IEEE Robotics and Automation Letters,
[5] R. Altendorfer, N. Moore, H. Komsuoglu, M. Buehler, H. Brown,
vol.2,no.1,pp.34–40,2016.
D. McMordie, U. Saranli, R. Full, and D. E. Koditschek, “Rhex: A
[27] N. Doshi, K. Jayaram, S. Castellanos, S. Kuindersma, and R. J.
biologically inspired hexapod runner,” Autonomous Robots, vol. 11,
Wood, “Effective locomotion at multiple stride frequencies using
no.3,pp.207–213,2001.
proprioceptive feedback on a legged microrobot,” Bioinspiration &
[6] B. Andrews, B. Miller, J. Schmitt, and J. E. Clark, “Running over
biomimetics,2019.
unknownroughterrainwithaone-leggedplanarrobot,”Bioinspiration
&biomimetics,vol.6,no.2,p.026009,2011.
[7] S. Riese and A. Seyfarth, “Stance leg control: variation of leg
parameters supports stable hopping,” Bioinspiration & biomimetics,
vol.7,no.1,p.016006,2011.
[8] P. Birkmeyer, K. Peterson, and R. S. Fearing, “Dash: A dynamic
16ghexapedalrobot,”in2009IEEE/RSJInternationalConferenceon
IntelligentRobotsandSystems. IEEE,2009,pp.2683–2689.
[9] A.T.Baisch,C.Heimlich,M.Karpelson,andR.J.Wood,“Hamr3:An
autonomous1.7gambulatoryrobot,”in2011IEEE/RSJInternational
ConferenceonIntelligentRobotsandSystems. IEEE,2011,pp.5073–
5079.
[10] R.S.Pierre,W.Gosrich,andS.Bergbreiter,“A3d-printed1mglegged
microrobotrunningat15bodylengthspersecond,”2018.
[11] K. D. Mombaur, R. W. Longman, H. G. Bock, and J. P. Schlo¨der,
“Open-loopstablerunning,”Robotica,vol.23,no.1,pp.21–33,2005.
[12] J. D. Weingarten, G. A. Lopes, M. Buehler, R. E. Groff, and D. E.
Koditschek, “Automated gait adaptation for legged robots,” in IEEE
InternationalConferenceonRoboticsandAutomation,2004.Proceed-
ings.ICRA’04.2004,vol.3. IEEE,2004,pp.2153–2158.
[13] J.M.Brown,C.P.Carbiener,J.Nicholson,N.Hemenway,J.L.Pusey,
andJ.E.Clark,“Fore-aftlegspecializationcontrollerforadynamic
quadruped,”in2018IEEEInternationalConferenceonRoboticsand
Automation(ICRA). IEEE,2018,pp.1–9.
[14] S. Kuindersma, R. Deits, M. Fallon, A. Valenzuela, H. Dai, F. Per-
menter, T. Koolen, P. Marion, and R. Tedrake, “Optimization-based
locomotion planning, estimation, and control design for the atlas
humanoid robot,” Autonomous Robots, vol. 40, no. 3, pp. 429–455,
2016.
[15] J.DiCarlo,P.M.Wensing,B.Katz,G.Bledt,andS.Kim,“Dynamic
locomotion in the mit cheetah 3 through convex model-predictive
control,” in 2018 IEEE/RSJ International Conference on Intelligent
RobotsandSystems(IROS). IEEE,2018,pp.1–9.
[16] S.Feng,E.Whitman,X.Xinjilefu,andC.G.Atkeson,“Optimization-
based full body control for the darpa robotics challenge,” Journal of
FieldRobotics,vol.32,no.2,pp.293–312,2015.
[17] A.Wa¨chterandL.T.Biegler,“Ontheimplementationofaninterior-
point ﬁlter line-search algorithm for large-scale nonlinear program-
ming,”Mathematicalprogramming,vol.106,no.1,pp.25–57,2006.
[18] A. Hereid, S. Kolathaya, and A. D. Ames, “Online optimal gait
generation for bipedal walking robots using legendre pseudospectral
optimization,”in2016IEEE55thConferenceonDecisionandControl
(CDC). IEEE,2016,pp.6173–6179.
[19] K.Sreenath,H.-W.Park,I.Poulakakis,andJ.W.Grizzle,“Embedding
active force control within the compliant hybrid zero dynamics to
achieve stable, fast running on mabel,” The International Journal of
RoboticsResearch,vol.32,no.3,pp.324–345,2013.
[20] W.-L. Ma, S. Kolathaya, E. R. Ambrose, C. M. Hubicki, and A. D.
Ames,“Bipedalroboticrunningwithdurus-2d:Bridgingthegapbe-
tweentheoryandexperiment,”inProceedingsofthe20thInternational
ConferenceonHybridSystems:ComputationandControl,2017,pp.
265–274.
[21] D.J.Blackman,J.V.Nicholson,C.Ordonez,B.D.Miller,andJ.E.
Clark, “Gait development on minitaur, a direct drive quadrupedal
robot,” in Unmanned Systems Technology XVIII, vol. 9837. Inter-
nationalSocietyforOpticsandPhotonics,2016,p.98370I.
[22] A. Seyfarth, H. Geyer, M. Gu¨nther, and R. Blickhan, “A movement
criterion for running,” Journal of biomechanics, vol. 35, no. 5, pp.
649–655,2002.
489
Authorized licensed use limited to: University of New South Wales. Downloaded on September 20,2020 at 15:46:12 UTC from IEEE Xplore.  Restrictions apply. 