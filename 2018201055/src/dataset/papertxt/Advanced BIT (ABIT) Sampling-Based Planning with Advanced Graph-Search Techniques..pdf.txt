2020 IEEE International Conference on Robotics and Automation (ICRA)
31 May - 31 August, 2020. Paris, France
A Fast and Accurate Solution for Pose Estimation from 3D Correspondences
Lipu Zhou, Shengze Wang, and Michael Kaess
Abstract—Estimating pose from given 3D correspondences,
includingpoint-to-point,point-to-lineandpoint-to-planecorre-
spondences,isafundamentaltaskincomputervisionwithmany
applications. We present a fast and accurate solution for the
least-squaresproblemofthistask.Previousworksmainlyfocus
on studying the way to ﬁnd the global minimizer of the least-
squaresproblem.However,existingworksthatshowtheability
toachievetheglobalminimizerarestillunsuitableforreal-time
applications.Furthermore,asoneofcontributionsofthispaper,
we prove that there exist ambiguous conﬁgurations for any
number of lines and planes. These conﬁgurations have several Fig.1. Anambiguousconﬁgurationforfourpoint-to-linecorrespondences
solutionsintheory,whichmakesthecorrectsolutionmaycome whichhas2solutions,describedinlemma1.Weplotthesideview(left)and
from a local minimizer when the data are with noise. Previous the top view (right) of the cost (12) for the unknowns s1 and s2 deﬁned
worksbasedonconvexoptimizationwhichisunabletoﬁndlocal in (5). To the best of our knowledge, this is the ﬁrst work revealing the
existenceoftheambiguityforthe3Dregistrationproblem.
minimizers do not work in the ambiguous conﬁguration. Our
algorithm is efﬁcient and able to reveal local minimizers. We theglobalminimum,however,theirrunningtimemakesthem
employ the Cayley-Gibbs-Rodriguez (CGR) parameterization not suitable for real-time applications. Recently, Wientapper
of the rotation to derive a general rational cost for the three
[6] provided an efﬁcient algorithm, but their algorithm can
cases of 3D correspondences. The main contribution of this
notachievetheglobaloptimalityintheory,andhastheriskof
paper is to solve the ﬁrst-order optimality conditions of the
least-squares problem, which are of a complicated rational no solution. Furthermore, previous works generally assume
form. The central idea of our algorithm is to introduce some that the correct solution is the global minimizer. However,
intermediate unknowns to simplify the problem. Extensive ex- we ﬁnd that the correct solution may come from a local
perimentalresultsshowthatouralgorithmismorestablethan
minimizer in some conﬁgurations. The contributions of this
previous algorithms when the number N of correspondences
paper are as follows:
is small. Besides, when N is large, our algorithm achieves the
same accuracy as the state-of-the-art algorithm [1], but our First, we prove that there exist ambiguous conﬁgurations
algorithm is about 7 times faster than [1] in real applications. for any number of plane and line correspondences, which
leads to multiple solutions in theory. When a conﬁguration
I. INTRODUCTION
approximates ambiguity, the correct solution of the problem
Estimating the pose from 3D correspondences, i.e. point- maycomefromalocalminimizer.Therefore,previousworks
to-point,point-to-lineandpoint-to-planecorrespondences,is [2], [4], [1] that are only able to compute the global mini-
known as the 3D registration problem in the literature [2], mizer may fail in these cases. Revealing local minimizers is
[3],[4],[5],[1],[6].Itisoneofthefundamentalproblemsin essential for an algorithm to handle all the conﬁgurations of
computer vision with a wide range of applications, such as the 3D registration problem.
simultaneouslocalizationandmapping(SLAM)[7],[8],[9],
Second, we present an efﬁcient and accurate solution
[10],[11],extrinsiccalibration[12],[13],[14],[15],[16]and
for the 3D registration problem. We use the Cayley-Gibbs-
iterative closes point (ICP) framework [17]. Besides, some
Rodriguez (CGR) parametrization to represent the rotation,
camera pose estimation problems, such as the perspective-n-
which generates a rational cost function. We derive its
point (PnP) problem [18], [19], [20] and the perspective-
ﬁrst-order optimality conditions. They form a high order
n-line (PnL) problem [21], [22], can be transformed to
polynomial system, and are hard to solve. Four intermediate
a 3D registration problem [6]. However, the research on
unknownsareintroducedtorelaxtheoriginalproblem,which
this problem is not as thorough as other pose estimation
results in much simpler ﬁrst-order optimality conditions.
problems.
Gro¨bner basis method [23] is applied to solve this equation
Previous works mainly focus on solving the least-squares
system.ThenwereﬁnethesolutionbytheNewton-Raphson
problem. Although large progress has been made, achieving
method.
the optimal solution and the real-time performance is still
We evaluate our algorithm with synthetic and real data.
a challenge. Some algorithms [4], [1] are capable of ﬁnding
Extensive experimental results show that our algorithm sig-
niﬁcantly outperforms previous works [2], [4], [1], [6]when
ThisworkwaspartiallysupportedbytheOfﬁceofNavalResearchunder
grantN00014-16-1-2103. thenumberofcorrespondencesissmall.Besides,experimen-
Lipu Zhou, Shengze Wang and Michael Kaess are with the Robotics talresultsverifythatouralgorithmcanconvergetotheglobal
Institute, Carnegie Mellon University, Pittsburgh, PA 15213, USA
{ } minimizer with the same accuracy as the previous works
zhoulipu@outlook.com, shengzew,kaess @andrew.
cmu.edu with guaranteed globally optimality [4], [1], however, our
978-1-7281-7395-5/20/$31.00 ©2020 IEEE 1308
Authorized licensed use limited to: Carleton University. Downloaded on September 21,2020 at 05:57:47 UTC from IEEE Xplore.  Restrictions apply. algorithm is much faster.
II. RELATEDWORKS
This paper focuses on the pose estimation from point-
to-point, point-to-line and point-to-plane correspondences
correspondences. Pose estimation from point-to-point cor-
respondences has been solved in early works [24], [25],
[26]. There exist closed-form solutions for this problem.
However, estimating pose from point-to-line and point-to- Fig.2. (a)Poseestimationformixedpoint-to-point,point-to-lineandpoint-
to-plane correspondences. (b) A schematic of the point-to-point, point-to-
plane correspondences is more complicated. These 3D cor-
lineandpoint-to-planedistance.
respondences actually yield similar distance function, which
is employed by previous works to construct a general cost
function [2], [3], [4], [5], [1], [6]. The difference of various Efﬁciently and accurately estimating the pose from current
cost functions lies in the parameterization of the rotation 3D correspondences is critical for the ICP framework.
matrix. The raw rotation matrix is adopted in [3], [1], and
III. PROBLEMFORMULATION
the quaternion [25] is used in [2], [4], [5], [6]. Previous
In this paper, we use italic, boldfaced lowercase and
works mainly focus on ﬁnding the global minimizer of the
boldfaced uppercase letters to represent scalars, vectors and
resultingcostfunction.In[4],theyproposedaprovablyopti-
matrices, respectively. This paper focuses on the problem of
mal algorithm. They employed convex underestimators with
pose estimation from point-to-plane, point-to-line and point-
branch-and-bound methods to iteratively compute the global
to-point correspondences as demonstrated in Fig. 2 (a). Fig.
minimum of the cost function. Although this algorithm
2 (b) illustrates the distance of the three correspondences.
can guarantee global optimality, it is very time-consuming.
We ﬁrst consider the point-to-plane correspondence. 2 (b).
Olsson et al. [3] reduced the computational complexity
by applying the Lagrangian dual relaxation to approximate Suppose we have a point xl in one coordinate system
and the corresponding plane in another coordinate system
the cost function. Their experimental results showed that a
singleconvexsemideﬁniteprogramcanwellapproximatethe represented by the plane’s norm-one normal n and a point
original problem. Recently, an improved result is obtained yπ lying on it. Then the scalar residual between a point and
a plane can be written as
by a strengthened Lagrangian dual relaxation [1]. Although
−
without theoretical guarantees, their experimental results r =nT (Rx +t y ) (1)
π π π
show that this algorithm can achieve the global minimum.
For the point-to-line correspondence, we can calculate the
Although these algorithms [3], [1] have made progress
in efforts to reduce the computational time, they are still 3-dimensional residual vector between a point xl and the
not suitable to demanding real-time applications. Recently, corresponding line(cid:0)represented(cid:1) by the norm-one direction d
Wientapper [6] provided an efﬁcient algorithm based on and a point yl on it as
− −
Gro¨bner basis polynomial solver. They introduced the ﬁrst r = I ddT (Rx +t y ) (2)
l 3 l l
orderderivativesofthenorm-oneconstraintofthequaternion
into the ﬁrst order optimality conditions of the cost function where I3 is the identify matrix. Lastly, a point-to-point
as [20], rather than apply the Lagrangian formulation for correspondence yields a 3-dimensional residual vector
−
the norm-one constraint of the quaternion. This results in r =Rx +t y (3)
p p p
an efﬁcient solution, however, their result is not optimal in
theory. Furthermore, as the number of equations is greater R and t have 6 DoF. We adopt the concept, i.e. effective
numberofcorrespondences,deﬁnedin[1].Letusdenotethe
thanthenumberofunknowns,theequationsystemmayhave
no solution. They introduced 4 pre-rotations to solve the number of effective correspondences as N. One point-to-
plane, point-to-line and point-to-point correspondence pro-
problem 4 times to handle this problem. The pre-rotation is
tomaketheno-solutionproblemhappenlesslikely,however, vide 1, 2, and 3 constraints, respectively. For nπ point-
it can not fully solve this problem in theory. to-plane, nl point-to-line, an×d np poi×nt-to-point correspon-
3D registration without correspondence is an related but dences,wehaveN =nπ+2 nl+3 np.Thispaperseeks
more complicated problem. Several works [27], [28], [29], to estimate the pose for N >6.
[30] presented globally optimal solution for the 3D point IV. LEASTSQUARESSOLUTION
cloud registration without correspondence. The ICP frame-
Using the notation in (1), (2) and (3), we deﬁne our cost
(cid:80) (cid:80) (cid:80)
work [17] gives a general way to ﬁnd correspondences
function as follows
and the pose at the same time. Although this framework
was originally designed for the point, other 3D models can C (R,t)= nπ r2 + nl rTr + np rT r ,
also be introduced into this framework [31], [32], [33]. πlp i=1 πi i=1 li li i=1 pi pi (4)
s.t.RRT =I ,det(R)=1,
The ICP framework iteratively ﬁnds the nearest elements as 3
correspondences then calculates the pose until it converges. where det(R) represents the determinant of R.
1309
Authorized licensed use limited to: Carleton University. Downloaded on September 21,2020 at 05:57:47 UTC from IEEE Xplore.  Restrictions apply. { } { }
on planes and any R ,t and R ,t , there exist n
1 1 { 2} 2 { } l
lines and n planes to make R ,t and R ,t are
π 1 1 2 2
exactsolutionsforthen point-to-lineandn point-to-plane
l π
correspondences.
Proof: We ﬁrst consider the n points on lines. Deﬁne
l(cid:8) (cid:9)
xl is the ith point. According to Lemma 1, we can ﬁnd n
i { } { } l
lines to make R ,t and R ,t are exact solutions for
1 1 2 2 ↔
the n point-to-line correspondences xl l nl .
l i i i=1
Then we consider the n points on planes. For the jth
π
point xπ within them, we can deﬁne 1yπ =R xπ+t and
j j 1 j 1
Fig.3. Aschematicofapoint-to-lineambiguousconﬁguration(a)anda 2yπ = R xπ + t . Let us denote π as a plane passing
j 2 j 2 j
point-to-plane ambiguous conﬁguration (b) described in Lemma 1 and 2, through the line deﬁned by 1yπ and 2yπ. According to
respectively. (cid:8) (cid:9) j { j} { }
how we construct π , we know that R ,t and R ,t
j 1 1 2 2
A. Ambiguous Conﬁgurations are two solutions for the n point-to-plane correspondences
xπ ↔π nπ . π (cid:8) (cid:9)
In previous works, the global minimizer is treated as the j j j={1 } { }
optimal solution. It is well known that there is an unique Therefore, R1,t1 and R2,t2 are the↔two solutions
solution for at least three point-to-point correspondences, for the nl point-to-line corresponde{nces↔xli} li ni=l1 and
exceptforthedegenerateconﬁguration,i.e.allthepointsare nπ point-to-plane correspondences xπi πi ni=π1.
When measurements approximate an ambiguous conﬁgu-
collinear. However, for plane and line, there exist conﬁgura-
ration,apriorisrequiredtoidentifythecorrectsolution.The
tions which have several solutions. We call them as ambigu-
prior isgenerally available in realapplications. For instance,
ousconﬁgurations.Theambiguousconﬁgurationdiffersfrom
we generally have a rough estimation of the pose between
the degenerate conﬁguration. The ambiguous conﬁguration
two sensors in the extrinsic calibration problem [12], [13],
has several solutions, but the degenerate conﬁguration has
[14], [15], [16]. For the pose estimation in SLAM [7], [8],
inﬁnitesolutions.Forambiguouscases,theglobalminimizer
[9], [10], [11], current pose should be consistent with the
can only ﬁnd one solution, which may miss the correct
previous motion trajectory.
solution. Formally, we have the following lemma for point-
Previous works [2], [3], [4], [1] using convex approxima-
to-line correspondences.
{ } tion can only ﬁnd the global minimizer. However, the global
Lemma 1: For any n points and any R ,t and
{ } l { } 1 {1 } minimizer may not be the correct solution for a problem
R ,t ,thereexistn linestomake R ,t and R ,t
2 2 l 1 1 2 2 when measurements approximate an ambiguous conﬁgura-
the exact solutions for the n point-to-line correspondences.
l tion. Therefore, we can not simply omit local minimizers.
Proof: Deﬁne x the ith point of an arbitrary point
i { } { }
set with n points. For any R ,t and R ,t , we can B. Rotation Parameterization
l 1 1 2 2
have y1 = R x +t and y2 = R x +t . Then we can
i 1 i 1 i 2 i 2 Solving for the rotation matrix is the crux for pose esti-
use y1 and y2 to deﬁne a line l = [d ;y ] with direction
i − i i i i mation. Previous works [2], [4], [1], [6] adopt non-minimal
di = (cid:107)yy1i1−yy2i2(cid:107) andapointyi =yi1onit,asdemonstratedin representations for R, which results in additional quadratic
Fig.3(a)i.Aicc2ordingtohowweconstructl ,weknowthatl constraints in the minimization problem. This paper adopts
{ i } { }i
passesthroughy1 andy2.Therefore R ,t and R ,t the CGR parametrization [18], [34] which gives a minimal
i i 1{ 1 ↔ } 2 2
are two solutions for the n point-to-line x l nl . representationfortherotationmatrix,removingthequadratic
l i i i=1
Similarly, we have lemma 2 for point-to-plane correspon- constraints in (4) . The CGR parametrization expresses a
(cid:0)(cid:0) (cid:1) (cid:1)
dences. rotation matrix as
{ } { }
a{ndLem{Rm}3a,2t3:}F,{otrhaenrey}nexπisptoinnπts apnladnaensytoRm1,atk1e,{RR12,,tt12}, R= 1+R¯sTs, R¯ = 1−sTs I3+2[s]×+2ssT (5)
R ,t and R ,t are exact solutions for the n point-
to-p2lan2e correspon3de3nces. π where s=[s1;s2;s3] is a 3-dimensional vector, and [s]× is
Proof: Deﬁne x the ith point of an arbitrary point set the skew-symmetric matrix of s.
i { } { } { }
with n points. For any R ,t , R ,t and R ,t , C. Rational Form of the Residual
π 1 1 2 2 3 3
we can have yi1 = R1xi+t1, yi2 = R2xi+t2 and yi3 = Wewillshowthattheresidualsfrompoint-to-point,point-
R3xi +t3. Then we can ﬁnd a plane πi passing through to-line and point-to-plane correspondences have a general
yi1, yi2 and yi3, as demonstrated in Fig{. 3 (b).}A{ccording} form
to ho{w we c}onstruct πi, we know that R1,t1 , R2,t2 r =aTRb+aTt+c (6)
and R ,t are three solutions for the n point-to-plane g
3 3 { ↔ } π
correspondences x π nπ . where a and b are two 3-dimensional vectors and c is a
i i i=1
scalar. We ﬁrst consider the point-to-plane residual r in
(cid:2) (cid:3) (cid:0) (cid:1) (cid:2) − π (cid:3)
Finally,wehavethefollowingtheoremforn point-to-line (1). It is obvious that a = n, b = y and c = nTy .
l π π
and n point-to-plane correspondences. Let us then consider the point-to-line residual. We deﬁne
π −
Theorem 1: For any n points on lines and n points r = r1,r2,r3 T and A = I ddT = a1;a2;a3 ,
l π l l l l l 3 l l l
1310
Authorized licensed use limited to: Carleton University. Downloaded on September 21,2020 at 05:57:47 UTC from IEEE Xplore.  Restrictions apply. where a1,a2 and a3 are the three rows of A . Using this system, it is computationally demanding and numerically
l l l l
notation, equation (2) can be written as unstable to apply it to a high order polynomial system,
(cid:0) −(cid:1) as the experimental results in Fig. 4. The Newton-Raphson
ri =ai(Rx +t y ), i=1,2,3 (7)
l l l l method provides an alternative way to ﬁnd the roots of (14).
It is easy to ﬁnd that a = ai T, b = x and c = −aiy . Denote an equation system as G¯(x). For the kth iteration,
L(cid:2)astly, we(cid:3)consider the(cid:2)point-tlo-p(cid:3)oint corrlespondence. Sliml- the Newton-Raphson method updates the solution as
ilar to the point-to-line correspondence, we deﬁne rp = x =x − −J−1(x − )G¯(x − ) (15)
r1,r2,r3 T andI = e1;e2;e3 .Substitutingthisnotation k k 1 G¯ k 1 k 1
intpo (3p),pit is easy3to ﬁndl l l This iterative method requires an initial solution s0 and
t . In the next section, we will describe how to calculate an
− 0
rpi =eip(Rxp+t yp), i=1,2,3 (8) accurate s0 and t0.
The similarity between (8) and (7) is obvious. Therefore, ri E. Initial Estimation from Relaxation
p
also has the general form (6).
The difﬁculty of solving (14) lies in the denominator
Let t = [t1;t2;t3]. Substituting (5) into the general of CGR parameterization (5). To solve this problem, we
residual rg in (6) and adding the tree terms together yields introduce the following(cid:112)intermediate variable
aTR¯b kTv 1
rg = 1+sTs +aTt+c= 1+sTs (9) ρ= 1+s2+s2+s2. (16)
1 2 3
where kTv is a third order polynomial with terms v = Substituting (16) into (9) will transform (9) from a rational
[s21t1,s21t2,s21t3,s21,s1s2,s1s3,s1,s22t1,s22t2,s22t3,s22,s2s3, function to a polynomial function. Furthermore, we deﬁne
s ,s2t ,s2t ,s2t ,s2,s ,t ,t ,t ,1]T.
2 3 1 3 2 3 3 3 3 1 2 3 α=ρs , β =ρs , γ =ρs . (17)
1 2 3
D. First-Order Optimality Conditions
Using (16) and (17), the residual (9) can be expressed as
Nowweconsidertheleast-squaresproblem(4).Using(9),
(cid:2) (cid:3)
the squared residual can be represented as r =aTu+b Tt (18)
g g g
r2 = q(s,t) (10) whereu= α2,αβ,αγ,αρ,β2,βγ,βρ,γ2,γρ,ρ2,1 T.This
g (1+sTs)2 formulation turns the rational function (9) into a polynomial
whereq(s,t)=vTkk(cid:0)Tv(cid:1)isa6(cid:0)tho(cid:1)rderp(cid:0)oly(cid:1)nomialinsand function (18) that is easier to handle. Furthermore, t in (18)
t. For the point-to-line distance rTr in (4), we have is decoupled from R as in [6], [1], and (18) is linear in t.
li li Nowweconsidertheleast-squaresproblem(4)forthenew
rTlirli = rl1i 2+ rl2i 2+ rl3i 2 (11) upnokinnto-two-nlsin.eW,eansdtacnkthpeoirnets-itdou-paolsinftrocmorrneπsppoonidnet-ntcoe-psltaoneg,entl
Asmentionedabove,r1,r2 andr3 allhavethesameformas p
rsagm. Tehfeorremfoares,(t1h0e).pSoiinmlit-iltaolr-illyin,erTpdrilsiptawncilel arlTlsiorliyiwelidllthhaevseamthee where A is a (n +e3ng =+A3nu+) ×Bt11 matrix and B (i1s9a)
form as (10). After the summation of squared residuals in π× l p
(n +3n +3n ) 3 matrix. Then (4) can be written as
(4), we know that C would have the same rational form π l p
πlp
as (10). We write it as C (ρ,α,β,γ,t)=eTe (20)
πlp (cid:0) (cid:1) g g
C¯ (s,t) As (19) is linear for t, then t has a closed-form solution as
C (s,t)= πlp (12)
πlp (1+sTs)2 t=− BTB −1BTAu (21)
where C¯ is a 6th order polynomial function in s and t.
πlp Substituting (21) into (20), we derive a cost function only
To ﬁnd the critical points(cid:16)o(cid:0)f (12), w(cid:1)e ﬁrst calculate it(cid:17)s ﬁrst involving ρ,α,β,γ as
order optimality conditions as follows: (cid:0) (cid:1)
ggsi == ∂∂CC∂sππillpp == (1+s11Ts)3∂C¯π1lp+=sT0s, i∂=C∂¯sπ1ilp,2−,34siC¯πlp =0 where C C=πlpA(ρ−,αB,βB,γT)B=−u1TBCTTAC.uTh=eueTleQmuents in(2th2e)
ti ∂ti ((cid:0)1+sTs)2 (cid:1)∂ti (13) vteercmto.rTuhuasre(s2e2c)onisdaorfdoeurrtmhoonrodmeriaplsoleyxncoemptiaflorfuthnectcioonn.stWanet
Canceling the denominator of (13) yields
compute the ﬁrst order optimality conditions to get all the
g¯ = 1+sTs ∂C¯πlp −4s C¯ =0 stationary points. This ﬁrst-order condition contains four
g¯si = ∂C¯πlp =0, i∂s=i 1,2,3i πlp (14) third order polynomials for ρ,α,β and γ as
ti ∂ti ∂C ∂C
∂C¯πlp and ∂C¯πlp are of degree 5. Therefore, g¯ and g¯ gρ = ∂ρπlp =0, gα = ∂απlp =0,
ar∂esiof degree∂t7i and 5, respectively. Although thsei Gro¨bnetir ∂C ∂C (23)
basis method gives a general way to solve the polynomial gβ = ∂βπlp =0, gγ = ∂γπlp =0.
1311
Authorized licensed use limited to: Carleton University. Downloaded on September 21,2020 at 05:57:47 UTC from IEEE Xplore.  Restrictions apply. The solution of (23) includes the global and local mini-
mizers of C . According to Be´zout’s theorem [23], there
πlp
exist at most 34 =81 solutions. We ﬁnd that the polynomial
system in (23) only contains third and ﬁrst degree monomi-
als.Thisequationsystemstratiﬁesthe2-foldsymmetry[35],
[36],[19].Thatistosayifanynontrivialξ =[ρ,α,β,γ]T is
−
a solution, ξ is also a solution. Thus there are at most 40
independent solutions. We adopt the algorithm introduced in
[37] to generate the polynomial solver which can utilize this Fig. 4. Compare our least-squares solution with the direct least-squares
solution(DLSSol)whichdirectlysolvesthepolynomialsystem(14).
property to yield an efﬁcient solution.
After solving (23), we are then able to compute t from
(21). The CGR parameters s ,s and s can be recovered
1 2 3
from the deﬁnitions in (16) and (17). The above formulation
treatsρ,α,β,γ asindependentunknowns.However,theyare
related as they are functions of s ,s and s . To recover the
1 2 3
minimizer of (12), we reﬁne the solution using the Newton-
Raphson iteration method in (15). We summarize our least-
squares solution in Algorithm 1.
Algorithm 1 Least-squares solution Fig.5. Rotationandtranslationerrorsforincreasingnumberofcorrespon-
dences.Thenoiselevelisﬁxedto0.05m.
Input: n point-to-plane, n point-to-line, and n point-to-
π l p
point correspondences
Effect of our intermediate unknowns As it is gener-
Output: R and t ally difﬁcult to get astable solution for a high order polyno-
1. Compute the coefﬁcient matrices A and B in (19).
mial system [23], we introduce 4 intermediate unknowns to
2. Compute Q in (22).
simplifytheleast-squaresproblem.Toverifytheirbeneﬁt,we
3. Compute the ﬁrst order optimality conditions (23)
evaluate the performance of the direct least-squares solution
4. Solve the equation system (23) for ρ,α,β,γ.
(DLSSol) for the polynomial system (14). We employed the
5. Recover s ,s ,s using (17).
1 2 3 algorithm in [37] to generate the solver. We ran 2000 trials
6. Compute t from (21). ∈
for each N [7,15]. Fig. 4 shows the results. Directly
7. Reﬁne the solution by Newton-Raphson iteration (15).
solving(14)canrecoverthestaticpointsofcostfunction(12)
in theory. However, the large mean errors of DLSSol verify
that this polynomial solver is very unstable. Furthermore,
V. EXPERIMENTS the computational time of DLSSol and our algorithm are
20.0 ms and 2.95 ms, respectively. Our solution is about 7
In this section, we compare our algorithm with the state-
times faster than DLSSol. The above results verify that our
of-the-art algorithms, including Briales’s algorithm [1], BnB
intermediate unknowns can increase the numerical stability
[4], Olsson’s algorithm [3] and Wientapper’s algorithm [6].
as well as signiﬁcantly reduce the computational time.
Least-squares solution We conduct experiments to
A. Experiments with Synthetic Data
evaluate the performances of different algorithms under
Our synthetic data are generated as [1]. Speciﬁcally, each varyingnumberofcorrespondences,increasinglevelofnoise
geometric element is determined by randomly sampling a and computational time. The results of all experiments are
point within a sphere of radius 10m. For lines and planes, from 100 independent trials as [1].
a random unit direction and normal are generated. We The ﬁrst experiment considers a ﬁxed noise level and an
uniformly sample the Euler angles ϕ,ϑ,ψ of the rotation
∈ ◦ ◦ ∈ ◦ ◦
matrix(ϕ,ψ [0 ,360 ]andϑ [0 ,180 ]).Thetranslation
−
elements are uniformly distributed within [ 10m,10m]. We
use Rˆ and ˆt to represent the estimated rotation and trans-
lation and use R and t to represent the ground truth.
(cid:13) gt (cid:13) gt
The rotation e(cid:13)rror is e(cid:13)valuated by the angle of the axis-
−
angle representation of R 1R, and the translation error is
− g(cid:107)t (cid:107)
evaluated by t ˆt / t . We consider the effective
gt 2 gt
numberofthecorrespondencesas[1].Forn point-to-plane,
π
n point-to-line, and n point-to-point correspondences, the
l p
number of correspondences for is calculated as N = n +
π
2nl+3np.GivenanN,werandomlygenerateacombination Fig. 6. Rotation and translation errors for increasing noise level. The
of point, line and point whose effective number is N. numberofeffectivecorrespondencesissetto10.
1312
Authorized licensed use limited to: Carleton University. Downloaded on September 21,2020 at 05:57:47 UTC from IEEE Xplore.  Restrictions apply. TABLEI
EXPERIMENTALRESULTSONTHE03,04,AND07SEQUENCESOFTHEKITTIDATASET[38].
KITTI03 KITTI04 KITTI07
Method ◦ ◦ ◦
tErr(%) RErr( ) Time(s) tErr(%) RErr( ) Time(s) tErr(%) RErr( ) Time(s)
Olsson[3] 2.03e-1 5.46e-1 2.22 5.75e-1 5.76e-1 1.88 3.60e-1 2.53e-1 2.08
Wientapper[6] 2.00e-1 5.72e-1 0.58 4.32e-1 3.49e-1 0.55 3.61e-1 2.58e-1 0.56
Briales[1] 1.96e-1 5.61e-1 2.16 4.31e-1 3.37e-1 1.88 3.60e-1 2.53e-1 2.03
Ours 1.95e-1 5.61e-1 0.33 4.31e-1 3.37e-1 0.30 3.60e-1 2.53e-1 0.30
There are more than 20,000 correspondences in each frame,
with the majority being the point-to-plane correspondence.
For each frame, 2D feature points are detected by the
ORB feature detector [39]. We project LiDAR points into
the image plane, and select the LiDAR points around an
ORB feature. Then, we ﬁt a plane to these LiDAR points.
Finally, we compute the 3D coordinates of an ORB feature
by calculating the intersection of the back-projection ray of
the ORB feature and the plane. We use the ORB descriptor
to match with the 2D feature points in the previous frame,
Fig.7. Computationaltimeofdifferentalgorithms. then we obtain the 3D point-to-point correspondences.
Next, we generate the point-to-line correspondence. For
TABLEII
each frame, 2D lines are detected by the Line Segment
AVERAGENUMBERSOFPOINT-TO-POINT(P-TO-P), Detector (LSD) [40] and described by the Line Band De-
POINT-TO-PINE(P-TO-L),ANDPOINT-TO-PLANE(P-TO-PL) scriptor (LBD) [41]. A 2D line is represented by two
CORRESPONDENCESPERFRAMEFOR03,04AND07KITTISEQUENCES. endpoints. The two 3D endpoints of a line are calculated
as it is done for the 2D feature point described above. We
Sequences AverageCorrespondencesPerFrame generate3Dlinecorrespondencesbymatchingtheir2DLBD
#P-to-P #P-to-L #P-to-PL
features. Given a line-to-line correspondence, two point-to-
KITTI03 63 17 21117
line correspondences are generated for the 2 endpoints.
KITTI04 37 30 19994
KITTI07 111 40 20126 Finally, we get the point-to-plane correspondence. For
eachframe,planesareextractedfromtheLiDARpointcloud
increasing number of correspondences. Let us denote the by the region growing algorithm [42]. Then we ﬁnd the
standarddeviationofazeromeanGaussiannoisedistribution nearest plane point in the previous frame to generate the
asδ.Wesetδ =0.05m.N variesfrom7to15.Fig.5shows point-to-plane correspondence.
theresult.TheresultsofBnB[4]andBriales’salgorithm[1] Given the initial correspondences as described above, we
overlap.Thisisconsistenttotheresultsin[1].Thecompared run at most 3 ICP iterations to handle the outlier. In each
algorithms are all unstable for a small N. Our algorithm iteration, we eliminate the correspondences with distance
signiﬁcantlyoutperformsthemwhenN issmall.WhenN is larger than 5cm as outliers. We evaluate the performance
large, our algorithm achieves the same accuracy as [4], [1]. of different algorithms on sequences 03, 04, and 07 of the
Wientapper’s method [6] can not ﬁnd the optimal solution KITTI dataset. We did not test BnB [4], as it is extremely
even N is large. slow on this large dataset. Our algorithm achieves the same
In the second experiment, δ is from 0.01m to 0.11m, or slightly better result as the state-of-the-art algorithm [1]
steppingby0.02m.TheresultsareillustratedinFig.6.BnB, while being about 7 times faster, as shown in Table I.
Briales’s algorithm and our algorithm present better results
VI. CONCLUSIONS
than other algorithms. Our algorithm gives a slightly better
This paper presents an efﬁcient and accurate solution
result than BnB and Briales’s algorithm when δ =0.11m.
for the 3D registration problem. We proof that there exists
Inthelastexperiment,wecomparethecomputationaltime
ambiguous conﬁgurations for any number of point-to-plane
of different algorithms. We vary the effective number of
andpoint-to-linecorrespondences.Thisrequiresanalgorithm
correspondences N from 10 to 2000. For every N, we run
should have the ability to reveal local minimizers. We use
each algorithm 100 times to calculate the average running
theCGRparameterizationtorepresenttherotation,removing
time. Fig. 7 provides the result. We did not run the BnB
the constraints on the rotation. However, this results in a
algorithm[4],becauseitistooslowforalargeN.Itisclear
rational form cost which is hard to solve. We introduce 4
that our algorithm is the fastest one among the compared
intermediate variables to simplify the ﬁrst order optimality
algorithms.
conditions. We evaluate our algorithm through synthetic and
B. Experiments with Real Data
real data. The experimental results show that our algorithm
We generated our real-world dataset from the KITTI is more stable for a small N, and is as accurate as the state-
dataset [38]. The characteristics of the dataset is in Table II. of-the-art algorithm [1] when N is large, but is much faster.
1313
Authorized licensed use limited to: Carleton University. Downloaded on September 21,2020 at 05:57:47 UTC from IEEE Xplore.  Restrictions apply. REFERENCES [23] D. A. Cox, J. Little, and D. O’shea, Using algebraic geometry.
SpringerScience&BusinessMedia,2006,vol.185.
[1] J. Briales and J. Gonzalez-Jimenez, “Convex global 3d registration [24] K. S. Arun, T. S. Huang, and S. D. Blostein, “Least-squares ﬁtting
with lagrangian duality,” in International Conference on Computer of two 3-d point sets,” IEEE Transactions on pattern analysis and
VisionandPatternRecognition(CVPR),2017. machineintelligence,no.5,pp.698–700,1987.
[2] C. Olsson, F. Kahl, and M. Oskarsson, “The registration problem [25] B.K.Horn,“Closed-formsolutionofabsoluteorientationusingunit
revisited: Optimal solutions from points, lines and planes,” in Com- quaternions,”Josaa,vol.4,no.4,pp.629–642,1987.
puter Vision and Pattern Recognition, 2006 IEEE Computer Society [26] B. K. Horn, H. M. Hilden, and S. Negahdaripour, “Closed-form
Conferenceon,vol.1. IEEE,2006,pp.1206–1213. solution of absolute orientation using orthonormal matrices,” JOSA
[3] C.OlssonandA.Eriksson,“Solvingquadraticallyconstrainedgeomet- A,vol.5,no.7,pp.1127–1135,1988.
rical problems using lagrangian duality,” in 2008 19th International [27] H. Li and R. Hartley, “The 3d-3d registration problem revisited,” in
ConferenceonPatternRecognition. IEEE,2008,pp.1–5. 2007IEEE11thInternationalConferenceonComputerVision. IEEE,
[4] C. Olsson, F. Kahl, and M. Oskarsson, “Branch-and-bound methods 2007,pp.1–8.
for euclidean registration problems,” IEEE Transactions on Pattern [28] C. Papazov and D. Burschka, “Stochastic global optimization for
AnalysisandMachineIntelligence,vol.31,no.5,pp.783–794,2009. robustpointsetregistration,”ComputerVisionandImageUnderstand-
[5] F.WientapperandA.Kuijper,“Unifyingalgebraicsolversforscaled ing,vol.115,no.12,pp.1598–1609,2011.
euclideanregistrationfrompoint,lineandplaneconstraints,”inAsian [29] J.Yang,H.Li,andY.Jia,“Go-icp:Solving3dregistrationefﬁciently
ConferenceonComputerVision. Springer,2016,pp.52–66. and globally optimally,” in Proceedings of the IEEE International
[6] F. Wientapper, M. Schmitt, M. Fraissinet-Tachet, and A. Kuijper, ConferenceonComputerVision,2013,pp.1457–1464.
“A universal, closed-form approach for absolute pose problems,” [30] Q.-Y. Zhou, J. Park, and V. Koltun, “Fast global registration,” in
ComputerVisionandImageUnderstanding,vol.173,pp.57–75,2018. EuropeanConferenceonComputerVision. Springer,2016,pp.766–
[7] J. Zhang and S. Singh, “Visual-lidar odometry and mapping: Low- 782.
drift, robust, and fast,” in 2015 IEEE International Conference on [31] A. Segal, D. Haehnel, and S. Thrun, “Generalized-icp.” in Robotics:
RoboticsandAutomation(ICRA). IEEE,2015,pp.2174–2181. scienceandsystems,vol.2,no.4. IEEE,2015,pp.742–749.
[8] ——,“Loam:Lidarodometryandmappinginreal-time.”inRobotics: [32] A. Censi, “An icp variant using a point-to-line metric,” in Robotics
ScienceandSystems,vol.2,2014,p.9. and Automation, 2008. ICRA 2008. IEEE International Conference
[9] R. A. Newcombe, S. Izadi, O. Hilliges, D. Molyneaux, D. Kim, on. IEEE,2008,pp.19–25.
A. J. Davison, P. Kohi, J. Shotton, S. Hodges, and A. Fitzgibbon, [33] J.SeraﬁnandG.Grisetti,“Nicp:Densenormalbasedpointcloudreg-
“Kinectfusion: Real-time dense surface mapping and tracking,” in istration,” in 2015 IEEE/RSJ International Conference on Intelligent
2011IEEEInternationalSymposiumonMixedandAugmentedReality. RobotsandSystems(IROS). IEEE,2015,pp.742–749.
IEEE,2011,pp.127–136. [34] F.M.MirzaeiandS.I.Roumeliotis,“Optimalestimationofvanishing
[10] P. F. Proenc¸a and Y. Gao, “Probabilistic rgb-d odometry based on points in a manhattan world,” in 2011 International Conference on
points, lines and planes under depth uncertainty,” Robotics and Au- ComputerVision. IEEE,2011,pp.2454–2461.
tonomousSystems,vol.104,pp.25–39,2018. [35] V. Larsson and K. A˚stro¨m, “Uncovering symmetries in polynomial
[11] Y.Taguchi,Y.-D.Jian,S.Ramalingam,andC.Feng,“Point-planeslam systems,” in European Conference on Computer Vision. Springer,
forhand-held3dsensors,”in2013IEEEInternationalConferenceon 2016,pp.252–267.
RoboticsandAutomation. IEEE,2013,pp.5182–5189. [36] E. Ask, Y. Kuang, and K. A˚stro¨m, “Exploiting p-fold symmetries
[12] Q. Zhang and R. Pless, “Extrinsic calibration of a camera and laser for faster polynomial equation solving,” in Proceedings of the 21st
rangeﬁnder(improvescameracalibration),”in2004IEEE/RSJInter- InternationalConferenceonPatternRecognition(ICPR2012). IEEE,
national Conference on Intelligent Robots and Systems (IROS)(IEEE 2012,pp.3232–3235.
Cat.No.04CH37566),vol.3. IEEE,2004,pp.2301–2306. [37] V. Larsson, K. Astrom, and M. Oskarsson, “Efﬁcient solvers for
minimalproblemsbysyzygy-basedreduction,”inProceedingsofthe
[13] R.UnnikrishnanandM.Hebert,“Fastextrinsiccalibrationofalaser
IEEEConferenceonComputerVisionandPatternRecognition,2017,
rangeﬁndertoacamera,”RoboticsInstitute,Pittsburgh,PA,Tech.Rep.
pp.820–829.
CMU-RI-TR-05-09,2005.
[38] A.Geiger,P.Lenz,C.Stiller,andR.Urtasun,“Visionmeetsrobotics:
[14] O.Naroditsky,A.Patterson,andK.Daniilidis,“Automaticalignment
Thekittidataset,”InternationalJournalofRoboticsResearch(IJRR),
ofacamerawithalinescanlidarsystem,”in2011IEEEInternational
2013.
ConferenceonRoboticsandAutomation. IEEE,2011,pp.3429–3434.
[39] E. Rublee, V. Rabaud, K. Konolige, and G. R. Bradski, “Orb: An
[15] R. Gomez-Ojeda, J. Briales, E. Fernandez-Moral, and J. Gonzalez-
efﬁcientalternativetosiftorsurf,”2011.
Jimenez,“Extrinsiccalibrationofa2dlaser-rangeﬁnderandacamera
[40] G. Randall, J. Jakubowicz, R. G. von Gioi, and J. Morel,
based on scene corners,” in 2015 IEEE International Conference on
“Lsd: A fast line segment detector with a false detection
RoboticsandAutomation(ICRA). IEEE,2015,pp.3611–3616.
control,” IEEE Transactions on Pattern Analysis and Machine
[16] L. Zhou, Z. Li, and M. Kaess, “Automatic extrinsic calibration of a
Intelligence, vol. 32, pp. 722–732, 12 2008. [Online]. Available:
cameraanda3dlidarusinglineandplanecorrespondences,”in2018
doi.ieeecomputersociety.org/10.1109/TPAMI.2008.300
IEEE/RSJInternationalConferenceonIntelligentRobotsandSystems
[41] L.ZhangandR.Koch,“Anefﬁcientandrobustlinesegmentmatching
(IROS). IEEE,2018,pp.5562–5569.
approachbasedonlbddescriptorandpairwisegeometricconsistency,”
[17] P.J.BeslandN.D.McKay,“Methodforregistrationof3-dshapes,”in
JournalofVisualCommunicationandImageRepresentation,vol.24,
SensorFusionIV:ControlParadigmsandDataStructures,vol.1611.
no.7,pp.794–805,2013.
InternationalSocietyforOpticsandPhotonics,1992,pp.586–607.
[42] J. Poppinga, N. Vaskevicius, A. Birk, and K. Pathak, “Fast plane
[18] J.A.HeschandS.I.Roumeliotis,“Adirectleast-squares(dls)method
detection and polygonalization in noisy 3d range images,” in 2008
for pnp,” in 2011 International Conference on Computer Vision.
IEEE/RSJInternationalConferenceonIntelligentRobotsandSystems.
IEEE,2011,pp.383–390.
IEEE,2008,pp.3378–3383.
[19] Y. Zheng, Y. Kuang, S. Sugimoto, K. Astrom, and M. Okutomi,
“Revisiting the pnp problem: A fast, general and optimal solution,”
in Proceedings of the IEEE International Conference on Computer
Vision,2013,pp.2344–2351.
[20] L. Kneip, H. Li, and Y. Seo, “Upnp: An optimal o (n) solution to
the absolute pose problem with universal applicability,” in European
ConferenceonComputerVision. Springer,2014,pp.127–142.
[21] C.Xu,L.Zhang,L.Cheng,andR.Koch,“Poseestimationfromline
correspondences:Acompleteanalysisandaseriesofsolutions,”IEEE
transactions on pattern analysis and machine intelligence, vol. 39,
no.6,pp.1209–1222,2017.
[22] B.Pˇribyl,P.Zemcˇ´ık,andM.Cˇad´ık,“Absoluteposeestimationfrom
line correspondences using direct linear transformation,” Computer
VisionandImageUnderstanding,vol.161,pp.130–144,2017.
1314
Authorized licensed use limited to: Carleton University. Downloaded on September 21,2020 at 05:57:47 UTC from IEEE Xplore.  Restrictions apply. 