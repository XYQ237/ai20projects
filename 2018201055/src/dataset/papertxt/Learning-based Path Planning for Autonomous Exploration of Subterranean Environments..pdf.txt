2020 IEEE International Conference on Robotics and Automation (ICRA)
31 May - 31 August, 2020. Paris, France
Probabilistic Data Association via Mixture Models for
Robust Semantic SLAM
(cid:3) (cid:3)
Kevin J. Doherty1, David P. Baxter1; , Edward Schneeweiss1;2; , and John J. Leonard1
Abstract(cid:151)Modern robotic systems sense the environment
geometrically, through sensors like cameras, lidar, and sonar,
as well as semantically, often through visual models learned
from data, such as object detectors. We aim to develop
robots that can use all of these sources of information for
reliable navigation, but each is corrupted by noise. Rather
than assume that object detection will eventually achieve near
perfect performance across the lifetime of a robot, in this
work we represent and cope with the semantic and geometric
uncertainty inherent in object detection methods. Speci(cid:2)cally,
we model data association ambiguity, which is typically non-
Gaussian, in a way that is amenable to solution within the
common nonlinear Gaussian formulation of simultaneous lo-
calization and mapping (SLAM). We do so by eliminating
data association variables from the inference process through
max-marginalization, preserving standard Gaussian posterior
assumptions. The result is a max-mixture-type model that Fig. 1: Illustrative overview of the proposed approach. (a) Several
accounts for multiple data association hypotheses. We provide objectdetectionsaremade.(b)Robotposeambiguity(bluecovari-
experimentalresultsonindoorandoutdoorsemanticnavigation ance ellipse) results in multiple candidate landmark associations,
tasks with noisy odometry and object detection and (cid:2)nd that the most likely of which may be incorrect. (c) All candidate
the ability of the proposed approach to represent multiple associationsforameasurementarerepresentedasa(cid:147)max-mixture(cid:148)
hypotheses, including the (cid:147)null(cid:148) hypothesis, gives substantial after data association variables are marginalized out. (d) Future
robustness advantages in comparison to alternative semantic evidence allows for the association to (cid:147)switch(cid:148) to the correct
SLAM approaches. hypothesis, (cid:2)xing the loop closure.
I. INTRODUCTION
thecorrectsemanticclassofeachlandmark.However,node-
The ability to build and use a map of environmental
tection system can be expected to have perfect performance
landmarks to navigate is one of the greatest strengths of
over the lifetime of a robot. Rather than build navigation
the landmark-based simultaneous localization and mapping
systems that depend on perfect detection and classi(cid:2)cation,
(SLAM) paradigm, but hinges critically on reliable recogni-
we aim to develop methods that can take into consideration
tion of previously mapped landmarks, i.e. data association.
the error characterization of perception systems like neural
Consistent data association over long periods of time is
network-based object detectors.
vital if we aim to achieve robust robot navigation in the
Robustness to misclassi(cid:2)cation and pose uncertainty re-
operational limit as (cid:147)time goes to in(cid:2)nity.(cid:148) Unfortunately,
quirestheabilitiestorepresentandresolveambiguityindata
long-term data association is substantially more challenging
association, and to reject incorrect loop closures. Traditional
than short-term data association, since uncertainty in robot
methods represent the problem of (cid:2)nding the correct set of
pose may grow large enough that many previously observed
hypotheses as a tree-search problem, where each node of
landmarks may be reasonable, albeit erroneous, candidates
the tree represents an association decision. Mitigating the
foraloopclosure.Forthisreason,anymechanismbywhich
we can associate landmarks uniquely is of interest. complexity of search requires careful pruning of plausible
hypotheses. Rather than explicitly search over association
Recent advances in the capabilities and reliability of deep
hypotheses,inthisworkwemarginalizeoutdataassociation
neural networks for object detection and feature extraction
variablesateachpointintime,allowingassociationstoarise
havemotivatedtheuseofsemanticstodistinguishlandmarks,
implicitly from the inference of pose and landmark values.
taken to be objects, in the environment, and infer over time
The main contribution of this work is an approximate
1Computer Science and Arti(cid:2)cial Intelligence Laboratory (CSAIL), max-marginalization procedure for data associations which
Massachusetts Institute of Technology (MIT), Cambridge, MA 02139. provides theoretical grounding for a (cid:147)max-mixture(cid:148)-type
f g
kdoherty, baxterdp, jleonard @mit.edu.
factor [1] within the context of semantic SLAM (shown in
2Autonomous Mobile Robotics Laboratory (AMRL), University
of Massachusetts Amherst (UMass Amherst), Amherst, MA 01003 Figure1);thustakingstepstowardaunifyingperspectiveon
(cid:3)
eschneeweiss@umass.edu. Equalcontributors. previous work in (cid:147)robust SLAM(cid:148) and recent work on data
ThisworkwaspartiallysupportedbytheOf(cid:2)ceofNavalResearchunder
association for semantic SLAM, e.g. [2]. Approximate max-
grantN00014-18-1-2832.K.DohertyacknowledgessupportfromtheNSF
GraduateResearchFellowshipProgram. marginalizationeliminatesdataassociationvariablesinaway
978-1-7281-7395-5/20/$31.00 ©2020 IEEE 1098
Authorized licensed use limited to: Cornell University Library. Downloaded on September 16,2020 at 02:18:23 UTC from IEEE Xplore.  Restrictions apply. that preserves standard Gaussian distribution assumptions in considered probabilistic data association making use of
SLAMinwhatotherwisebecomesanon-Gaussianinference expectation-maximization[2],oralternatebetweensampling
problem [3]. Our approach makes use of error charac- data associations and recomputing SLAM solutions [18]. In
terization of an object detector, taking into consideration contrast to [2], we model data associations as a mixture,
uncertainty to fuse detection information with geometric ratherthanaveragingsolutionsfordifferentassociations.We
information from other sensors, like stereo cameras. Lastly, also marginalize out poses and landmarks when computing
the proposed method incorporates loop closure rejection via dataassociationprobabilities,whereasin[2],pointestimates
incorporation of a null-hypothesis association, which we of robot poses and landmarks are used to compute data as-
experimentally (cid:2)nd to be critical in providing robustness to sociationweights.Inboth[2]and[18],convergencerequires
odometry noise and misclassi(cid:2)cation in the semantic SLAM iteratively recomputing data associations and performing
problem. factor graph optimization; we aim to avoid the complexity
The remainder of this paper proceeds as follows. In associatedwiththisrecomputation.Inpreviouswork[3],we
Section II we discuss related works on the topics of data addressed this problem for the general non-Gaussian SLAM
association,robustSLAM,andsemanticSLAM.Wedescribe case using nonparametric belief propagation. While that ap-
the problem of semantic SLAM with unknown data associ- proach gives rich uncertainties representing data association
ation in Section III, where we outline our approach to data ambiguity, in this work our goal is maximum a posteriori
association at a high-level. In Section IV we describe in inference speci(cid:2)cally in the nonlinear Gaussian case.
detail the max-marginalization procedure, data association
weight computation, and de(cid:2)ne the (cid:147)semantic max-mixture III. SEMANTICSLAMWITHUNKNOWNDATA
factor(cid:148)usedforoptimization,includingtherepresentationof ASSOCIATION
null-hypothesis data association for loop closure rejection. The semantic SLAM problem can be de(cid:2)ned as the
f 2Xg
Finally,experimentalresultsdemonstratingtherobustnessof inference of vehicle poses X= x T and landmark
f 2 Lg t t=1
the proposed approach to odometry noise and misclassi(cid:2)- states L = ‘ M , given a set of measurements
f 2 Zg j j=1
cation during indoor navigation and results from the KITTI z T . This corresponds to the following maximum
t t=1
dataset [4] are provided in Section V. a posteriori (MAP) inference problem:
j
II. RELATEDWORK X^;L^ =argmaxp(X;L Z): (1)
The proposed work intersects the topics of data associa- X;L
X ,
tion, robust SLAM, and semantic SLAM. Classical work on We consider the vehicle state space SE(3) throughout,
data association stems from target-tracking literature, where whileweconsiderlandmarkstatescontainingbothgeometric
L , R (cid:2)C
probabilisticdataassociation(PDA)[5]andmulti-hypothesis and semantic components, i.e. 3 (for landmarks
L , (cid:2) C
tracking (MHT) [6] were introduced. Subsequently these with only a positional component) or SE(3)
methods were applied to early (cid:2)ltering-based SLAM solu- (for 6 degree-of-freedom landmark pose estimation), where
C f g
tionsmakingGaussiannoiseassumptions[7],[8].FastSLAM = 1;:::;C is a (cid:2)xed, a priori known set of C discrete
[9] later introduced a particle (cid:2)ltering-based approach to semantic classes. When necessary, we denote the separate
the non-Gaussian inference problem of data association; a pose/positional components and semantic components of a
data association sampler was introduced that serves as an landmark ‘ as ‘p and ‘s, respectively. We assume multiple
j j j
alternative to explicit search over associations. measurements can be made at each point in time, such that
Laterworkintheareaofpose-graphoptimizationfocused z is the k-th measurement made at time t. Lastly, we con-
tk Z
on themes of multi-hypothesis SLAM and outlier rejection, sider the measurement space as having jointly geometric
including methods like switchable constraints [10], max- and semantic components, e.g. range-bearing measurements
C
mixtures [1], junction tree inference [11], and robust es- with semantic class in or 6-DoF pose measurements in
C
timation using convex relaxations [12](cid:150)[14]. These works SE(3) with semantic class in .
consider mitigating the effects of perceptual aliasing, often When associations between measurements and landmarks
f g
in the context of laser scan matching or appearance-based arenotknown,theymustbeinferred.WetakeD= d T
t t=1
loop closure (see, for example [15]), whereas in semantic tobethesetofassociationsofmeasurementsz atallpoints
t
SLAM we also want to locate and classify discrete objects. in time to landmarks, such that d =j indicates that the k-
tk
Nonetheless,aswedemonstrateinthiswork,landmark-based th measurement taken at time t corresponds to landmark ‘ .
j
semantic SLAM shares many similarities. Speci(cid:2)cally, by The most common approach to SLAM with unknown data
taking an approximate Bayesian inference approach to the associationisthatofmaximum-likelihood,inwhichthemost
semantic SLAM problem we arrive at a speci(cid:2)c case of probable set of data associations are computed and (cid:2)xed,
the max-mixtures method [1] where component weights are then used to solve for the most probable robot poses and
directly computed as candidate association probabilities. landmark states. This approach can be brittle, as a single
In the area of semantic SLAM, classi(cid:2)cations from object incorrectassociationcanmovetheoptimalsolutionforrobot
detectors have been used to aid data association [2], [3], poses and landmark states far from their true values.
[16](cid:150)[18]. While many such works consider maximum- In order to mitigate the effects of data association errors
likelihood data association [16], [17], recent works have one may consider probabilistic data association, in which
1099
Authorized licensed use limited to: Cornell University Library. Downloaded on September 16,2020 at 02:18:23 UTC from IEEE Xplore.  Restrictions apply. multiple associations for a measurement are given consid-
eration commensurate with their probability. Generally this
corresponds with marginalization of the data association
variable, i.e.
X
j E j j
p(X;L Z)= [p(X;L D;Z) Z] (2)
D
j j
= p(X;L D;Z)p(D Z):
D (a) Association probabilities computed by marginalizing out poses
Common assumptions of additive Gaussian measurement and landmarks.
j
noise make p(X;L D;Z) Gaussian, such that the resulting
j
belief p(X;L Z) is a sum of Gaussians, which generally
falls outside the realm of traditional nonlinear least-squares
optimization approaches to SLAM.
A recent approach to semantic SLAM [2] preserves the
Gaussian nature of the problem by replacing the above
j
expectation with one over logp(X;L D;Z), leading to an (b)Dataassociationmax-marginalizationproducesamixturefactor.
expectation-maximization algorithm for optimization. Con-
Fig.2:Illustrativeexampleofdataassociationvariablemarginaliza-
vergence requires recomputation of the association weights
j tion. In 2a, we marginalize out poses and landmarks to compute a
p(D Z), and prior to convergence the solution will lie distributionovercandidatedataassociations(seeSectionIV-B).In
somewhere between those obtained given (cid:2)xed associations. 2b,wecomputethemax-marginaloverdataassociations,resulting
We propose an alternative solution to the MAP inference in a max-mixture factor (see Section IV-C).
problem in which the (cid:147)sum-marginal(cid:148) above is replaced by
the (cid:147)max-marginal(cid:148):
j , j j where each factor f is in correspondence with one of
p^(X;L Z) maxp(X;L D;Z)p(D Z): (3) i
the relevant (odometric or landmark) measurement models.
D
j From the measurement models, there is a clear partition
Each component of the max-marginal p^(X;L Z) is a
of geometric information from the odometry and geometric
weighted Gaussian, while the max operator simply acts to
landmark measurement models (which depend on both the
switch to the (cid:147)best(cid:148) data associations for any given point in
robot poses and landmark locations) and the semantic infor-
the latent space of X and L. The optimal solution for the
mation, which depends only on the class of the associated
max-marginal is identical to the MAP solution for the true
landmark. Since we do not know data associations, we in-
posterior in (2) [19]. Exact computation of the true max-
steadinferthemfromdata.Atahighlevel,ourapproachisto
marginal is generally intractable due to the combinatorial
applyvariableeliminationtodataassociationstoproducean
number of plausible data associations, but as we will show,
equivalent factor graph with data associations marginalized
several reasonable approximations make the max-marginal a
out. The proposed max-mixture semantic SLAM approach
practicalmethodfordealingwithdataassociationambiguity.
approximates optimization over the max-marginal in (3). In
IV. MAX-MIXTURESEMANTICSLAM particular, we introduce a proactive max-marginalization
We consider a standard Gaussian SLAM framework with procedure for computing data association weights. For
j
an odometry model p(x x (cid:0) ) that is Gaussian with associations to previous landmarks, as well as for the null-
t t 1
covariance (cid:6) with respect to the relative transform from hypothesis case, the max-marginal over candidate associa-
t
x (cid:0) to x , denoted g(x ;x (cid:0) ) and Gaussian geometric tions is represented as a factor (in the factor graph SLAM
t 1 t tj t 1
measurement model p(zp x ;‘ ) with covariance (cid:0), with framework) taking on the form of a (cid:147)max-mixture(cid:148) [1].
tk t j
respect to the nonlinear function h(x ;‘ )1. Semantic mea- We term these factors, semantic max-mixture factors. The
j t j
surements with model p(zs ‘s) are assumed independent addition of null-hypothesis data association enables the
tk j
oftheposefromwhichalandmarkwasobserved,aswellas rejection of incorrect loop closures. The resulting factor
itsposition,andasin[2],[3]theyaretakenassamplesfrom graph is amenable to optimization using standard nonlinear
a categorical distribution with probability vector de(cid:2)ned by least-squares techniques, from which the optimal robot and
aclassi(cid:2)erconfusionmatrix(assumedtobeknownapriori). landmark states can be recovered.
Lastly,weassumethegeometricandsemanticmeasurements
j j j
factor as p(z x ;‘p)=p(zp x ;‘ )p(zs ‘s). A. Proactive Max-Marginalization
tk t j tk t jj tk j
The unnormalized posYterior p(X;L Z), can be written Exact computation of the max-marginal over all possible
in the following general factor graph formulation:
data associations in Equation (3) is computationally expen-
j / (cid:18)f g
p(X;L Z) f (V ); V X;L ; (4) sive due to the combinatorial growth in the size of the set
i i i
of possible data associations over time. Marginalizing out
i
data associations proactively, i.e. as new measurements are
1The function h in this work is taken to be a relative transform in the made, and ignoring the in(cid:3)uence of future measurements on
caseoffulllandmarkposemeasurements,orbearing,elevation,andrange
whenonlylandmarkpositioninformationisavailable. associationprobabilitiesallowsustomitigatethecomplexity
1100
Authorized licensed use limited to: Cornell University Library. Downloaded on September 16,2020 at 02:18:23 UTC from IEEE Xplore.  Restrictions apply. 0.12 B. Data Association Weight Computation
Known DA
Translation Error (m)1234 Rotation Error (rad)00000.....0000124680 MGSSeePLmmDAaannttiicc  MMMM  (+O NurHs )(Ours) ospuurorCrebmocaanbessineliidttceyoorfinassthsipsierntosglpalooenfrdmttimhoeenaarasjkluo.rtieonWmttehgeeneaotslmisokufeemtalriehilcaotnohaddenmdpda(asrztekatmkzaaj,snsdwtoitchckii;camZhtie(cid:0)oiann)-
with poses and landmarks marginalized out (see Figure
0 0.00
2a). From the factored measurement model assumption, the
0 S2imulated 4Odometry6 Noise Ga8in 10 0 S2imulated 4Odometry6 Noise Ga8in 10 j (cid:0)
likelihood of the form p(z d ;Z ) can be broken into
(a) tk tk
the product of separate semantic and geometric likelihoods:
0.12
4 0.10 j (cid:0)
p(z d =j;Z )=
Translation Error (m)123 Rotation Error (rad)000...000468 Eachttekrmotnkpt(hzetsrkigjhdtt-kha=ndj;siZd(cid:0)e)cpa(nzbtpkejexdptkan=dejd;Zas(cid:0)f)o:llo(w7s)
0.02 into the summation over landmark classes:
0 0.00 X
0 10 20 30 40 50 0 10 20 30 40 50
Misclassification Rate Misclassification Rate j (cid:0)
p(zs d =j;Z )=
(b) tk tk
j j (cid:0)
p(zs ‘s =c)p(‘s =c Z ); (8)
Fig. 3: Translation and rotation error as a function of (a) the tk j j
simulated odometry noise and (b) misclassi(cid:2)cation rate parame- c
ters.Theprobabilisticapproachesgenerallyoutperformmaximum-
and integral over robot pose and landmark location:
likelihood,butthemostsigni(cid:2)cantadvantagescomefromtheincor-
ZZ
poration of the null-hypothesis into the mixture-based framework,
j (cid:0)
which outperforms all other methods across all misclassi(cid:2)cation p(zp d =j;Z )=
tk tk
rates and odometry noise. Legend is consistent throughout.
j j (cid:0)
p(zp d =j;x ;‘ )p(x ;‘ Z )dx d‘ : (9)
tk tk t j t j t j
j
of full max-marginalization. Withdataassociationsmarginalizedout,thebeliefp(x ;‘
(cid:0) t j
In particular, suppose we have some set of previous Z ) would be generally non-Gaussian. Consequently, we
(cid:0)
measurements Z and new measurements Z+ . We aim to again make an approximation and use the single Gaussian
j
computethemax-marginaloverassociationstothenewmea- component corresponding to the max-marginal p^(x ;‘
(cid:0) t j
surements, denoted D+. Formally, we have the following: Z ) evaluated at thje cu(cid:0)rrent estimate of xt and ‘j, ) which
we denote p^(x^ ;‘^ Z ):
t j
j (cid:0) / ZZ
p(X;L;D+ Z+;Z )
j (cid:0) (cid:25)
p(Z+ jX;L;D+)p(X;LjZ(cid:0))p(D+ jZ(cid:0)); (5) p(ztpk dtk =j;Z )
j j (cid:0)
p(zp d =j;x ;‘ )p^(x^ ;‘^ Z )dx d‘ : (10)
from Bayes’ rule, where we have used the conditional inde- tk tk t j t j t j
j (cid:0) j
pendences p(Z+ X;L;D+;Z )=p(Z+ X;L;D+), and
j (cid:0) j (cid:0) Since all of the terms in the integral are now Gaussian, it
p(X;L D+;Z ) = p(X;L Z ), since D+ consists of
(cid:0) can be simpli(cid:2)ed as follows, based on the method of [20]:
associations to only measurements outside of Z . Applying
max-marginalization to data associations, we obtain:
j (cid:0) (cid:25)
(cid:2) (cid:3) p(zp d =j;Z )p
tk tk
p^(X;LjjZ(cid:0)+;Z(cid:0))= j j (cid:0) j 1 je(cid:0)12kh(x^)(cid:0)ztpkk2Rtjk; (11)
p(X;L Z )max p(Z+ X;L;D+)p(D+ Z ) : (6) 2(cid:25)Rtjk
D+
Here p(X;L j Z(cid:0)) is the (potentially non-Gaussian) pos- wThheerceox^vairsiatnhceemRean,oifsthdee(cid:2)jo(cid:12)(cid:12)niendtadsis:t(cid:12)(cid:12)ribution over xt and ‘j.
terior distribution over poses and landmarks after sum- tjk (cid:12) (cid:12)
(cid:12) (cid:12)
(cid:0)
marginalizationofdataassociationstothemeasurementsZ . , @h @h T
For the purposes of optimization in the Gaussian case, we R (cid:6) +(cid:0); (12)
j (cid:0) tjk @x @x
take this as the max-marginal p^(X;L Z ). x^ x^
The consequences of this simple change are signi(cid:2)cant: where (cid:6) is the block joint covariance matrix between pose
evaluating the max operators in the above expression no x and candidate landmark ‘ , @h=@x is the Jacobian of
t j
longerrequiresexaminationofpreviousassociationsandcan the measurement function, and (cid:0) is the covariance of the
bedoneinlineartimeforthemostrecentmeasurement.The geometric measurement model. This result, combined with
resultisthatwehavearrivedatanapproximatemax-product theexpressionin(8)givesthemarginallikelihoodin(7)that
algorithm for SLAM with unknown data associations. we normalize to compute data association probabilities.
1101
Authorized licensed use limited to: Cornell University Library. Downloaded on September 16,2020 at 02:18:23 UTC from IEEE Xplore.  Restrictions apply. 50 50 Experiments were run on a single core of a 2.2 GHz Intel i7
40 40 CPU. We use evo [26] for trajectory evaluation3.
30 30
y (m)1200 y (m)20 In both experiments, we compared two variants of the
0 10 proposed method: semantic max-mixtures (MM) and se-
−10 0
−20 −10 mantic max-mixtures with null-hypothesis data associa-
−80 −60 −40 −20 0 20 40 60 −80 −60 −40 −20 0 20 40 60
x (m) x (m) tion (MM+NH) to a known data association (Known DA)
(a) Max-Likelihood (b) Gaussian PDA
baseline, na¤(cid:17)ve maximum-likelihood (ML) data association
50 50 (which makes a single association with the landmark max-
40 40
imizing Eq. (7)), as well as an expectation-maximization
30 30
y (m)20 y (m)20 approach similar to that of [2], here referred to as Gaussian
10 10
0 0 probabilistic data association (GPDA). We use a threshold
−10 −10 on the marginal likelihood in (7) to identify new landmarks,
−80 −60 −40 −20 0 20 40 60 −80 −60 −40 −20 0 20 40 60
x (m) x (m) as well as to produce the set of landmark candidates. This is
(c) Semantic MM (Ours) (d) Semantic MM + NH (Ours)
similar to standard Mahalanobis distance-based thresholds,
Fig.4:EstimatedtrajectoriesfortheMITRACECARdataset(origin but also considers the semantic likelihood4.
aligned);referencetrajectoryinblack.Associationerrorscausethe
maximum-likelihood approach to produce additional hallways. A. MIT RACECAR Dataset
We collected roughly 25 minutes of data during indoor
navigation with the MIT RACECAR mobile robot platform
C. Semantic Max-Mixture Factor
over a roughly 1.08 km trajectory. We sampled AprilTag
Assuminguniformpriorsondataassociations,thedistribu- [27], [28] detection keyframes at a rate of 1 Hz resulting in
j (cid:0)
tionp(d Z )isproportionaltothemarginallikelihoodin 702observationsof262uniquetags.Odometrywasobtained
tk
(7)andcansimplybenormalizedoverallassignmentstod . using the ZED stereo camera visual odometry [24]. The
H(cid:18)f g tk
This results in a set 1;:::;M of candidate landmark use of AprilTags uniquely allows us to obtain a baseline
hypotheses, max-marginalization of which produces a max- (cid:147)ground-truth(cid:148) solution with known data associations. We
mixture factor for a measurement z : arti(cid:2)cially assigned semantic labels to each AprilTag by
tk
j j (cid:0) consideringthetruetagIDmoduloC foraC-classsemantic
f(x ;‘H)=maxp(z x ;‘ )p(d =j Z ): (13)
t 2H tk t j tk SLAM problem. In the experiments presented in this paper,
j
The max-marginalization step is visualized in Figure 2b, we use C = 2 classes, as we found it to be one of the
mostchallengingsituations5.WhileAprilTagsgivegenerally
where we have eliminated the data association variable from
H accurate orientation information, we typically cannot expect
theinferenceprocess.Byaugmentingthecandidateset to
H[f;g thisofneuralnetwork-basedobjectdetectors.Forthisreason,
be , we allow a null-hypothesis data association to
we set a large standard error on roll, pitch, and yaw of
be made. In practice, we assume a probability for the null-
AprilTag detections to prevent orientation information from
hypothesis and normalize the remaining data associations
giving any substantial data association cues. Furthermore,
such that the total probability of the augmented hypothesis
thisexperimentalsetupallowsustoapplyclassi(cid:2)cationerror
set equals 1. The null-hypothesis component is assumed to
and simulate additional odometry noise in a repeatable way
be Gaussian with large standard deviation (e.g. 105).
to observe the performance of each method with noise in
Finally, we can recover maximum a posteriori landmark
classi(cid:2)cation and odometry.
semantic class estimatesY(assXuming uniform priors) as in [2]
In Figure 3, we provide box-plots summarizing statistical
as follows:
results of trajectory error on the MIT RACECAR dataset.
j
‘^s =argmax p(d ;‘s =c Z); (14) Speci(cid:2)cally, we considered robustness to simulated addi-
j t j
c t dt tional odometry noise and detector misclassi(cid:2)cation. We
calibrated an initial odometry model, but in testing we add
which are recovered using the data association probabilities
storedasthecomponentweightsofthemax-mixturefactors. simulated Gaussian noise of x, y, and yaw6, multiplied by a
scale factor varying from 0 to 10. We simulate classi(cid:2)cation
V. EXPERIMENTALRESULTS error for a misclassi(cid:2)cation rate (cid:11) (from 0% to 50%) by
All computational experiments were implemented in C++ sampling from a semantic measurement model with confu-
(cid:0)
using the Robot Operating System (ROS) [21] and the im- sion matrix equal to 1 (cid:11) on the diagonal and (cid:11) on the off-
plementationofiSAM2[22]withintheGTSAM[23]library
3We provide trajectory comparisons for all of the methods tested
for optimization and covariance recovery. We demonstrate
without landmarks visualized, but more detailed visualizations and
our approach on 3D visual SLAM tasks using data collected videos can be found on the project page: https://github.com/
during indoor navigation with an MIT RACECAR vehicle2 MarineRoboticsGroup/mixtures_semantic_slam
equipped only with a ZED stereo camera [24], as well as 4Weusea(cid:31)2testwithcon(cid:2)dence0.9andnull-hypothesisweightof0.1.
5Ingeneral,witha(cid:147)good(cid:148)detector,thepresenceofmanyuniquesemantic
with stereo image data from the KITTI dataset [4], [25].
classesamonglandmarksmakesthedataassociationproblemeasier.
6We take the baseline simulated noise model as (cid:27)x = 1:5mm, (cid:27)y =
2https://mit-racecar.github.io/ 0:75mm,andforyaw,(cid:27)(cid:13) =0:000225radinrobotframe.
1102
Authorized licensed use limited to: Cornell University Library. Downloaded on September 16,2020 at 02:18:23 UTC from IEEE Xplore.  Restrictions apply. 200 200 200 200
100 100 100 100
y (m) 0 y (m) 0 y (m) 0 y (m) 0
−100 −100 −100 −100
−200 −200 −200 −200
−100 0 100 200 300 0 100 200 300 0 100 200 300 0 100 200 300
x (m) x (m) x (m) x (m)
(a) Max-Likelihood (b) Gaussian PDA (c) Semantic MM (Ours) (d) Semantic MM + NH (Ours)
Fig. 5: Estimated trajectories for KITTI Sequence 5. False loop closures cause the maximum-likelihood data association method to fail
catastrophically, while all of the probabilistic methods show improved robustness.
Method MaxError MeanError MedianError RMSE
the maximum-likelihood approach fails catastrophically due
ML 126.46 52.78 59.66 62.35
to incorrect loop closures. These results are corroborated by
GPDA 30.76 10.52 8.90 12.11
MM 23.23 9.31 8.31 11.37 the translation and rotation errors, summarized in Tables I
MM+NH 19.88 6.48 6.44 7.70 and II, respectively.
TABLE I: Translation error (m) on KITTI Sequence 5.
VI. CONCLUSIONANDFUTUREWORK
Method MaxError MeanError MedianError RMSE We have proposed an approach to semantic SLAM with
ML 0.42 0.15 0.11 0.19
probabilistic data association based on approximate max-
GPDA 0.51 0.06 0.052 0.069
MM 0.54 0.055 0.049 0.065 marginalization of data associations. This led to a (cid:147)max-
MM+NH 0.58 0.043 0.037 0.053 mixture(cid:148)-type approach to factor graph SLAM, amenable to
TABLE II: Rotation error (rad) on the KITTI Sequence 5. nonlinear least-squares optimization. We have shown how
mixture component weights can be computed from joint
semantic and geometric measurements, and null-hypothesis
diagonal. We (cid:2)nd that while errors in all methods increase associations can be incorporated to reject bad loop closures.
with added noise in odometry and misclassi(cid:2)cation, all of We evaluated the proposed approach on real stereo image
the probabilistic methods generally outperform maximum- datawithknowndataassociationsusingAprilTags[27]under
likelihood. Most signi(cid:2)cantly, we (cid:2)nd that the addition of a variety of simulated odometry and detection noise models,
the null-hypothesis to our approach drastically reduces error as well as on stereo image data from the KITTI dataset
inalltests.Beyondtheabilityofthenull-hypothesismethod using noisy detections of cars as landmarks. We have shown
torejectbadloopclosures,theadditionofthenullhypothesis that our approach is competitive with recent expectation-
mayhelppreventthemax-mixturesapproachfrombecoming maximization methods for data association in semantic
(cid:147)stuck(cid:148) in a local optimum by decreasing the high cost SLAM and drastically outperforms the common maximum-
associated with being (cid:147)between(cid:148) hypotheses; a region that likelihood approach, particularly with use of null-hypothesis
must be crossed before hypothesis switching can take place. data association, while being similarly easy to implement
We contextualize these quantitative results with qualitative within existing factor graph optimization frameworks. The
trajectories plotted in Figure 4 for a 2-class problem with particular bene(cid:2)ts of the null-hypothesis in the proposed
10% misclassi(cid:2)cation and 10% additional odometry error. framework suggest that the ability to reject incorrect loop
closures is a necessity for semantic SLAM systems relying
B. KITTI Dataset
onobjectdetectors,andthisworkisonesteptowardunifying
We also evaluate our approach on stereo camera data existing literature in robust SLAM with recent work on data
from the KITTI dataset odometry sequence 5 [4]. In our association for object-level/semantic SLAM.
experiments, we use the MobileNet-SSD object detector ( In this work we used classi(cid:2)cations from object detectors
[29](cid:150)[31]), from which detections were obtained at ap- to disambiguate data associations, but alternative semantic
proximately 10 Hz. We threshold the con(cid:2)dence of the descriptors can be modeled and incorporated similarly, for
detector at 0.8, using detections of cars as landmarks. We example using neural network-based feature matching tech-
use VISO2 stereo odometry for visual odometry [32]. We niques [33](cid:150)[35]. Additionally, our experience simulating
estimate the range and bearing to cars as the average range semantic SLAM with AprilTags suggested that orientation
and bearing to all points tracked by VISO2 that project can provide very useful cues for data association. While we
into the bounding box for a given car detection. Despite focused on approaches that give limited geometric informa-
this very noisy landmark signal, we show qualitatively in tion about objects, methods like [36] that infer the full pose
Figure5thatalloftheprobabilisticdataassociationmethods of objects may greatly improve accuracy and robustness of
successfully recover reasonable trajectory estimates, while data association.
1103
Authorized licensed use limited to: Cornell University Library. Downloaded on September 16,2020 at 02:18:23 UTC from IEEE Xplore.  Restrictions apply. REFERENCES [19] D.Koller,N.Friedman,andF.Bach,Probabilisticgraphicalmodels:
principlesandtechniques. MITpress,2009.
[1] E.OlsonandP.Agarwal,(cid:147)Inferenceonnetworksofmixturesforro- [20] M. Kaess and F. Dellaert, (cid:147)Covariance recovery from a square root
bustrobotmapping,(cid:148)TheInternationalJournalofRoboticsResearch, information matrix for data association,(cid:148) Robotics and autonomous
vol.32,no.7,pp.826(cid:150)840,2013. systems,vol.57,no.12,pp.1198(cid:150)1210,2009.
[2] S. L. Bowman, N. Atanasov, K. Daniilidis, and G. J. Pappas, [21] M. Quigley, K. Conley, B. P. Gerkey, J. Faust, T. Foote, J. Leibs,
(cid:147)ProbabilisticdataassociationforsemanticSLAM,(cid:148)inRoboticsand R. Wheeler, and A. Y. Ng, (cid:147)ROS: an open-source robot operating
Automation(ICRA),2017IEEEInternationalConferenceon. IEEE, system,(cid:148)inICRAWorkshoponOpenSourceSoftware,2009.
2017,pp.1722(cid:150)1729. [22] M. Kaess, H. Johannsson, R. Roberts, V. Ila, J. J. Leonard, and
[3] K. Doherty, D. Fourie, and J. J. Leonard, (cid:147)Multimodal semantic F. Dellaert, (cid:147)iSAM2: Incremental smoothing and mapping using the
SLAMwithprobabilisticdataassociation,(cid:148)in2019IEEEInternational Bayestree,(cid:148)TheInternationalJournalofRoboticsResearch,vol.31,
ConferenceonRoboticsandAutomation(ICRA). IEEE,2019. no.2,pp.216(cid:150)235,2012.
[4] A. Geiger, P. Lenz, and R. Urtasun, (cid:147)Are we ready for autonomous [23] F. Dellaert, (cid:147)Factor graphs and GTSAM: A hands-on introduction,(cid:148)
driving? the KITTI Vision Benchmark Suite,(cid:148) in Conference on GeorgiaInstituteofTechnology,Tech.Rep.,2012.
ComputerVisionandPatternRecognition(CVPR),2012. [24] (cid:147)StereoLabs ZED camera.(cid:148) [Online]. Available: https://www.
[5] D.Reid,(cid:147)Analgorithmfortrackingmultipletargets,(cid:148)IEEEtransac- stereolabs.com/zed/
tionsonAutomaticControl,vol.24,no.6,pp.843(cid:150)854,1979. [25] A.Geiger,P.Lenz,C.Stiller,andR.Urtasun,(cid:147)Visionmeetsrobotics:
[6] Y.Bar-ShalomandE.Tse,(cid:147)Trackinginaclutteredenvironmentwith Thekittidataset,(cid:148)InternationalJournalofRoboticsResearch(IJRR),
probabilistic data association,(cid:148) Automatica, vol. 11, no. 5, pp. 451(cid:150) 2013.
460,1975. [26] M.Grupp,(cid:147)evo:Pythonpackagefortheevaluationofodometryand
[7] I.J.CoxandJ.J.Leonard,(cid:147)Modelingadynamicenvironmentusinga slam.(cid:148)https://github.com/MichaelGrupp/evo,2017.
bayesianmultiplehypothesisapproach,(cid:148)Arti(cid:2)cialIntelligence,vol.66, [27] J. Wang and E. Olson, (cid:147)AprilTag 2: Ef(cid:2)cient and robust (cid:2)ducial
no.2,pp.311(cid:150)344,1994. detection,(cid:148)in2016IEEE/RSJInternationalConferenceonIntelligent
[8] (cid:151)(cid:151),(cid:147)Probabilisticdataassociationfordynamicworldmodeling:A RobotsandSystems(IROS). IEEE,oct2016,pp.4193(cid:150)4198.
multiplehypothesisapproach,(cid:148)inAdvancedRobotics,1991.’Robotsin [28] D. Malyuta, C. Brommer, D. Hentzen, T. Stastny, R. Siegwart, and
UnstructuredEnvironments’,91ICAR.,FifthInternationalConference R.Brockers,(cid:147)Long-durationfullyautonomousoperationofrotorcraft
on. IEEE,1991,pp.1287(cid:150)1294. unmanned aerial systems for remote-sensing data acquisition,(cid:148)
[9] M. Montemerlo, S. Thrun, D. Koller, and B. Wegbreit, (cid:147)FastSLAM: JournalofFieldRobotics,p.arXiv:1908.06381,Aug.2019.[Online].
A factored solution to the simultaneous localization and mapping Available:https://doi.org/10.1002/rob.21898
problem,(cid:148) in Proc. of the AAAI National Conference on Arti(cid:2)cial [29] J. Huang, V. Rathod, C. Sun, M. Zhu, A. Korattikara, A. Fathi,
Intelligence,2002,2002. I.Fischer,Z.Wojna,Y.Song,S.Guadarramaetal.,(cid:147)Speed/accuracy
[10] N. Su¤nderhauf and P. Protzel, (cid:147)Switchable constraints for robust trade-offsformodernconvolutionalobjectdetectors,(cid:148)inProceedings
pose graph SLAM,(cid:148) in Intelligent Robots and Systems (IROS), 2012 oftheIEEEConferenceonComputerVisionandPatternRecognition,
IEEE/RSJInternationalConferenceon. IEEE,2012,pp.1879(cid:150)1884. 2017,pp.7310(cid:150)7311.
[11] A.V.SegalandI.D.Reid,(cid:147)Hybridinferenceoptimizationforrobust [30] A. G. Howard, M. Zhu, B. Chen, D. Kalenichenko, W. Wang,
pose graph estimation,(cid:148) in 2014 IEEE/RSJ International Conference T. Weyand, M. Andreetto, and H. Adam, (cid:147)Mobilenets: Ef(cid:2)cient
onIntelligentRobotsandSystems. IEEE,2014,pp.2675(cid:150)2682. convolutional neural networks for mobile vision applications,(cid:148) arXiv
[12] L.Carlone,A.Censi,andF.Dellaert,(cid:147)Selectinggoodmeasurements preprintarXiv:1704.04861,2017.
via 1 relaxation: A convex approach for robust estimation over [31] W. Liu, D. Anguelov, D. Erhan, C. Szegedy, S. Reed, C.-Y. Fu,
graphs,(cid:148) in 2014 IEEE/RSJ International Conference on Intelligent and A. C. Berg, (cid:147)SSD: Single shot multibox detector,(cid:148) in European
RobotsandSystems. IEEE,2014,pp.2667(cid:150)2674. conferenceoncomputervision. Springer,2016,pp.21(cid:150)37.
[13] L. Carlone and G. C. Cala(cid:2)ore, (cid:147)Convex relaxations for pose graph [32] A. Geiger, J. Ziegler, and C. Stiller, (cid:147)StereoScan: Dense 3d Re-
optimization with outliers,(cid:148) IEEE Robotics and Automation Letters, construction in Real-time,(cid:148) in IEEE Intelligent Vehicles Symposium,
vol.3,no.2,pp.1160(cid:150)1167,2018. Baden-Baden,Germany,June2011.
[14] P.-Y.Lajoie,S.Hu,G.Beltrame,andL.Carlone,(cid:147)Modelingperceptual [33] Y.Tian,B.Fan,andF.Wu,(cid:147)L2-net:Deeplearningofdiscriminative
aliasing in slam via discrete(cid:150)continuous graphical models,(cid:148) IEEE patch descriptor in euclidean space,(cid:148) in Proceedings of the IEEE
RoboticsandAutomationLetters,vol.4,no.2,pp.1232(cid:150)1239,2019. Conference on Computer Vision and Pattern Recognition, 2017, pp.
661(cid:150)669.
[15] S.Lowry,N.Su¤nderhauf,P.Newman,J.J.Leonard,D.Cox,P.Corke,
[34] K. M. Yi, E. Trulls, V. Lepetit, and P. Fua, (cid:147)Lift: Learned invariant
andM.J.Milford,(cid:147)Visualplacerecognition:Asurvey,(cid:148)IEEETrans-
feature transform,(cid:148) in European Conference on Computer Vision.
actionsonRobotics,vol.32,no.1,pp.1(cid:150)19,2015.
Springer,2016,pp.467(cid:150)483.
[16] S.YangandS.Scherer,(cid:147)CubeSLAM:Monocular3Dobjectdetection
[35] X.Han,T.Leung,Y.Jia,R.Sukthankar,andA.C.Berg,(cid:147)Matchnet:
and SLAM without prior models,(cid:148) arXiv preprint arXiv:1806.00557,
Unifying feature and metric learning for patch-based matching,(cid:148) in
2018.
ProceedingsoftheIEEEConferenceonComputerVisionandPattern
[17] R. F. Salas-Moreno, R. A. Newcombe, H. Strasdat, P. H. Kelly, and
Recognition,2015,pp.3279(cid:150)3286.
A. J. Davison, (cid:147)SLAM++: Simultaneous localisation and mapping
[36] L.Nicholson,M.Milford,andN.Su¤nderhauf,(cid:147)QuadricSLAM:Con-
at the level of objects,(cid:148) in Proceedings of the IEEE conference on
strained Dual Quadrics from Object Detections as Landmarks in
computervisionandpatternrecognition,2013,pp.1352(cid:150)1359.
Semantic SLAM,(cid:148) IEEE Robotics and Automation Letters (RA-L),
[18] B. Mu, S.-Y. Liu, L. Paull, J. Leonard, and J. P. How, (cid:147)SLAM with
2018.
objectsusinganonparametricposegraph,(cid:148)inIntelligentRobotsand
Systems(IROS),2016IEEE/RSJInternationalConferenceon. IEEE,
2016,pp.4602(cid:150)4609.
1104
Authorized licensed use limited to: Cornell University Library. Downloaded on September 16,2020 at 02:18:23 UTC from IEEE Xplore.  Restrictions apply. 